# Stream Debug - 20250206_003745

# Original Question
```
What is ICOR?
```

# Context Content
```markdown
# Search Results for: What is ICOR?

Keywords: icor

## Variations
1. What does ICOR refer to?
2. Could you describe what ICOR is?
3. Please explain what ICOR is.
4. Can you clarify what ICOR signifies?
5. What signifies ICOR?


## Context

### Summary
**ICOV, ICOR, IEIG (0 or 1) control writing of covariance, correlation, and eigenvector matrices to a matrix file. IRES (0 or 1) controls writing of a resolution data file (case.rsd). JCOSAVE ("jcosave" or "nojcosave") controls Jacobian matrix file (case.jco) saving. JCOSAVEITN ("jcosaveitn" or "nojcosaveitn") saves a JCO file for each iteration. VERBOSEREC ("verboserec" or "noverboserec") controls run record file verbosity.**

### Header
**4.2.10 Ninth Line**

### Content
ICOV, ICOR and IEIG
If PEST is run in “estimation” mode, and if neither singular value decomposition nor LSQR is employed in solution of the inverse problem, then at the end of each iteration of the inversion process PEST can write a “matrix file” containing linear estimates of the posterior covariance and correlation coefficient matrices, as well as eigenvectors and eigenvalues of the posterior covariance matrix. Calculation of these matrices is based on the current Jacobian matrix. Settings of the ICOV, ICOR and IEIG variables determine which (if any) of these data are recorded in the matrix file. A setting of 1 for each of these variables will result in the corresponding information being recorded. On the other hand, a setting of 0 will result in the corresponding information not being recorded. Regardless of these settings, all of these matrices are recorded on the run record file at the end of the inversion process (provided, once again, that PEST is not run in “regularisation” mode and that neither singular value decomposition nor LSQR is used to solve the inverse problem.)
The posterior covariance matrix, together with its correlation coefficients and eigenvectors/eigenvalues, can be used to examine the “health” of an inverse problem in which regularisation is purely manual and therefore implied in the definition of the parameters themselves. This covariance matrix is computed using equation 5.2.13 of Doherty (2015). Note, however, that these matrices cannot be computed if an inverse problem is completely ill-posed.
A better way to compute a posterior covariance matrix is to use the PREDUNC7 utility; this is not troubled by problem ill-posedness. Other linear parameter and predictive uncertainty analysis possibilities are available through utilities discussed in part II of this manual. Furthermore, with mathematical regularisation in place, the information provided by eigenvector decomposition of the posterior covariance matrix, and by parameter correlation coefficients computed from this matrix, is not really needed, for the mathematical regularisation process, instead of the user, takes care of possible inverse problem ill-posedness. See Doherty (2015) for details.
IRES
This is an integer variable which controls the writing of a “resolution data file”. This is a binary file which is used by utilities such as RESPROC, RESWRIT and PARAMERR which compute the resolution matrix, and quantify post-calibration predictive error variance. The resolution data file is automatically named case.rsd, where case is the filename base of the PEST control file.
If omitted, IRES is set to 1. Writing of a resolution data file can therefore only be prevented if IRES is included in the PEST control file and specifically set to 0. This is its recommended setting, as the utility programs which use it are less informative than more recent programs such as those comprising the PREDVAR* and PREDUNC* suites which have superseded them; the latter programs do not read a resolution data file.
JCOSAVE
This optional text variable can be used to suppress recording of the binary Jacobian matrix file (i.e. JCO file). If supplied, it must be provided as “jcosave” or “nojcosave”. If omitted,
“jcosave” prevails. This variable can be placed anywhere following the mandatory IEIG or optional IRES variable on the ninth line of the “control data” section of the PEST control file. Its recommended value is “jcosave”, unless the inverse problem size is very large indeed and the MAXCOMPDIM variable has been employed to activate internal compressed Jacobian matrix storage; in the latter case the accessing of a large Jacobian matrix for the purpose of recording a JCO file can be computationally intensive.
JCOSAVEITN
JCOSAVEITN is an optional character variable which should be supplied as either “jcosaveitn” or “nojcosaveitn”. If the former string is supplied, PEST writes a JCO file at the end of every iteration, this containing the Jacobian matrix calculated during that iteration. The name of each such file is case.jco.N where N is the iteration number to which the JCO file pertains. Alternatively, if JCOSAVEITN is set to “nojcosaveitn”, or omitted altogether, PEST will not save a progression of JCO files in this manner. Note that the JCO file containing the Jacobian matrix corresponding to the best parameter set attained so far is saved to a file named case.jco in the usual manner, regardless of the setting of JCOSAVEITN. The JCOSAVEITN variable can be placed anywhere on the ninth line of the “control data” section of the PEST control file following ICOV, ICOR, IEIG and, optionally, IRES. JCOSAVEITN should be set to “jcosaveitn” if it is desired that the MULJCOSEN utility be employed for monitoring of changes to composite parameter and/or observation sensitivities during the inversion process. See part II of this manual for a description of this utility.
VERBOSEREC
Where parameter, observation and prior information numbers are high, the PEST run record file becomes voluminous - so voluminous that it is almost impossible for a user to obtain useful information from it. PEST will write a much shorter run record file if VERBOSEREC (a text variable) is set to “noverboserec”. The default value for this variable (i.e. the value that will prevail if it is not supplied at all) is “verboserec”. The VERBOSEREC variable can be placed anywhere following ICOV, ICOR, IEIG and, optionally, IRES on the ninth line of the “control data” section of the PEST control file.
REISAVEITN

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** PHISTOPTHRESH, PHIABANDON, and LASTRUN control null space Monte Carlo.  PHIABANDON (high value or file) stops calibration if the objective function is too high; LASTRUN (0 or 1) controls the final model run.  A PHIABANDON schedule file provides iteration-specific thresholds.  If the objective function exceeds the threshold, the parameter adjustment process is abandoned.
- **Next Summary:** REISAVEITN ("reisaveitn" or "noreisaveitn") controls saving interim residuals files (case.rei, case.rei.N). PARSAVEITN ("parsaveitn" or "noparsaveitn") saves parameter values (case.par.N) per iteration. PARSAVERUN ("parsaverun" or "noparsaverun") saves run-specific parameter values (BEOPEST only, case.par.N_M).  An optional "sensitivity reuse" section (Chapter 7) governs sensitivity reuse.  An optional "singular value decomposition" section is recommended for most applications.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG, IRES, JCOSAVE, JCOSAVEITN, MAXCOMPDIM, REISAVEITN, VERBOSEREC
- **Chunk ID:** 626d16643148
- **Chunk Index:** 1
- **Previous Chunk ID:** 421e7b0896aa
- **Next Chunk ID:** 70b3867d696b

---

## Context

### Summary
**EIGPROC summarizes information from case.rec and case.sen files.  It requires PESTMODE="estimation", ICOV=ICOR=IEIG=1,  a completed or "stop with statistics" run, and a well-posed problem (invertible JtQJ matrix). Use `eigproc case`.**

### Header
**8.2.1 General**

### Content
EIGPROC reads a PEST run record file and a PEST sensitivity file. It extracts and summarises information from these files. Recall that a PEST run record file is always named case.rec where case is the filename base of the PEST control file; a sensitivity file is named case.sen.
Use of EIGPROC (which stands for “eigenstuff processor”) is predicated on the following assumptions.
- PEST has been run in “estimation” mode.
- The ICOV, ICOR and IEIG variables in the “control data” section of the PEST control file are all set to 1.
- PEST has run to completion, or has been stopped using the “stop with statistics option”. (This will happen if the PSTOPST program has been run in another window).
- The parameter estimation problem is well posed so that the JtQJ matrix (often referred to as the “normal matrix”) inverted by PEST to obtain the parameter covariance matrix is not singular; thus a post‑calibration covariance matrix (and associated correlation coefficient and eigendata matrices) are recorded at the end of the run record file.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software
- **Main Section:** 8. PEST Statistical Postprocessing
- **Subsection:** 8.2 EIGPROC

### Additional Summaries
- **Higher-Level Summary:** In "predictive analysis" mode, PEST optimizes predictions while maintaining the objective function below a threshold, considering post-calibration uncertainty. It requires accurate derivatives, a prior calibration process, and parameter consistency with the estimation run. Users can adjust Marquardt lambda, search parameters, and incorporate predictive noise for improved analysis.
- **Detailed Summary:** In "predictive analysis" mode, PEST maximizes/minimizes a prediction (in the "predict" group) while keeping the objective function ≤ Φ0 (requires a prior "estimation" run).  It uses the same parameters, transformations, and observations as the estimation run.  Restarting uses `/r`, `/j`, `/d`, or `/s` (parallel runs).  Change limits remain important.  Screen output shows prediction values per iteration.  Results include the optimal prediction and parameter values.

### Related Context
- **Previous Summary:** This chapter details post-PEST run utilities analyzing calibration dataset information content and parameter estimability.  Some utilities (EIGPROC, PCOV2MAT, INFSTAT, INFSTAT1) are for well-posed problems; others (SUPCALC, IDENTPAR, SSSTAT) handle ill-posed problems.  GENLINPRED (analyzes prediction uncertainties, separate chapter) provides further insights.
- **Next Summary:** EIGPROC analyzes the parameter covariance matrix from a PEST run record file (case.rec) and sensitivity file (case.sen), requiring a well-posed "estimation" mode run (ICOV=ICOR=IEIG=1). Use `eigproc case N exlim outfile`: case specifies the control file, N is the number of eigenvalues, exlim is the eigenvector component threshold, and outfile is the output file.  Output includes eigenvalues, eigenvectors (components >exlim), sensitivities, and a correlation coefficient submatrix.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG
- **Chunk ID:** 5e652b0adadc
- **Chunk Index:** 1
- **Previous Chunk ID:** c5265fbb0e72
- **Next Chunk ID:** cf26a67b407b

---

## Context

### Summary
**ICOV, ICOR, and IEIG (integers) in the "control data" section are not used by PESTPP-GLM. Set them to 0 for PESTCHEK compatibility.**

### Header
**4.6.10 Ninth Line**

### Content
The integer ICOV, ICOR and IEIG variables recorded on the 9th line of the control data section of a PEST control file are not used by any members of the PESTPP-GLM suite. Set all of these to 0 for PESTCHEK-friendliness.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.6 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** The optional "automatic user intervention" section (section 6.3) governs automatic user intervention, activated by setting DOAUI to "doaui" in the "control data" section.  If omitted, default values are used.

### Related Context
- **Previous Summary:** NOPTMAX (integer, 50 recommended) sets maximum iterations; 0 runs one model; -1 or -2 generates a JCO file.  PESTPP-GLM uses PHIREDSTP (real, 0.005), NPHISTP (integer, 4), NPHINORED (integer, 4), RELPARSTP (real, 0.005), and NRELPAR (integer, 4) for termination; PESTPP-IES uses all except RELPARSTP and NRELPAR. Other PEST++ programs use only NOPTMAX.
- **Next Summary:** PESTPP-GLM uses SVD for inversion, with settings overridable via a "singular value decomposition" section (MAXSING, EIGTHRESH). MAXSING directly sets dimensionality; EIGTHRESH sets it implicitly (ratio of squared singular values of Q½J).  Omit this section to use PESTPP-GLM defaults.  MAXSING should equal or exceed the number of parameters unless dimensionality reduction is desired.  *max_n_super*/ *super_eigthresh* (PEST++) control super parameter numbers in SVD-assisted inversion;  MAXSING/EIGTHRESH control SVD regardless of base/super parameter estimation.  PESTPP-IES and PESTPP-DA also use internal SVD defaults, which are overridden if the "singular value decomposition" section is present.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG
- **Chunk ID:** e93b50160cd8
- **Chunk Index:** 1
- **Previous Chunk ID:** cbb14971764f
- **Next Chunk ID:** 1815f651636e

---

## Context

### Summary
**This appendix specifies the PEST control file format (Figure A1.1).  Variables are position-based, space/tab-delimited; strings with spaces are quoted.  Blank lines and comments (#) are allowed (PEST versions ≥15).  Optional variables are in brackets.  PEST++ uses "++" prefixed keywords; PEST ignores these.  The first line is "pcf".**

### Header
**14. References**

### Content
Wagner, B.J. and Gorelick, S.M., 1987. Optimal groundwater quality management under parameter uncertainty. *Water. Resour. Res.* 23(7), 1162-1174.
Welter, D.E., Doherty, J.E., Hunt, R.J., Muffels, C.T., Tonkin, M.J., and Schreüder, W.A., 2012. Approaches in highly parameterized inversion - PEST++, a Parameter ESTimation code optimized for large environmental models: U.S. Geological Survey Techniques and Methods, book 7, section C5, 47 p., available at .
Welter, D.E., White, J.T., Hunt, R.J., and Doherty, J.E., 2015. [Approaches in highly parameterized inversion: PEST++ Version 3, a Parameter ESTimation and uncertainty analysis software suite optimized for large environmental models](https://pubs.er.usgs.gov/publication/tm7C12). U.S. Geological Survey Techniques and Methods, book 7, section C12, 54 p.
White, J.T., 2018. A model-independent iterative ensemble smoother for efficient history-matching and uncertainty quantification in very high dimensions. Accepted for publication in *Environmental Modelling and Software*.
White, J.T., Fienen, M.N., Barlow, P.M. and Welter, D.E., 2018. A tool for efficient, model-independent management optimization under uncertainty. *Environmental Modelling and Software*, 100, 213-221.
White, J.T., Fienen, M.N. and Doherty, J.E., 2016. A Python framework for environmental model uncertainty analysis. *Environmental Modelling and Software*, 85, 217-228.
White, J.T., Doherty, J.E. and Hughes, J.D., 2014. Quantifying the predictive consequences of model error with linear subspace analysis. *Water Resour. Res*. 50 (2): 1152-1173. DOI: 10.1002/2013WR014767
Zhang, J., Lin, G., Li, W., Wu, L., & Zeng, L. (2018). An iterative local updating ensemble smoother for estimation and uncertainty assessment of hydrologic model parameters with multimodal distributions. *Water Resources Research*, 54, 1716– 1733.
**Appendix**
This appendix provides specifications for a PEST control file.
Variables are recognized by their position in the file. They must be placed on the correct line of this file and separated from their neighbours by at least one space.
PEST, BEOPEST and many of the PEST-support utility programs which are documented in part II of the PEST manual tolerate the presence of the following items in a PEST control file:
- blank lines;
- comments;
- lines that begin with the character string “++”.
Lines that begin with “++” are used for the insertion of variables which control the operation of the PEST++ suite of programs.
Comments can be placed on their own line. Alternatively, they can be placed at the end of a line which provides PEST control data. In either case, a comment follows a “#” character. Note, however, that this character is not construed as denoting the presence of an ensuing comment under any of the following circumstances:
- it is not preceded by a space, tab or the beginning of a line;
- it is part of a string that is enclosed in quotes.
These exceptions preclude mis-construing the presence of the “#” character in a filename as signifying the start of a comment.
Some of the older utilities that are documented in part II of the PEST manual do not tolerate the presence of blank lines, “++” lines or comments. All of these items can be removed from a PEST control file using the PSTCLEAN utility supplied with the PEST suite.
Figure A1.1 Names and locations of variables in the PEST control file. Optional variables are enclosed in square brackets.
pcf
\* control data
RSTFLE PESTMODE
NPAR NOBS NPARGP NPRIOR NOBSGP \[MAXCOMPDIM\]\[DERZEROLIM\]
NTPLFLE NINSFLE PRECIS DPOINT \[NUMCOM JACFILE MESSFILE\] \[OBSREREF\]
RLAMBDA1 RLAMFAC PHIRATSUF PHIREDLAM NUMLAM \[JACUPDATE\] \[LAMFORGIVE\] \[DERFORGIVE\]
RELPARMAX FACPARMAX FACORIG \[IBOUNDSTICK UPVECBEND\] \[ABSPARMAX\]
PHIREDSWH \[NOPTSWITCH\] \[SPLITSWH\] \[DOAUI\] \[DOSENREUSE\] \[BOUNDSCALE\]
NOPTMAX PHIREDSTP NPHISTP NPHINORED RELPARSTP NRELPAR \[PHISTOPTHRESH\] \[LASTRUN\] \[PHIABANDON\]
ICOV ICOR IEIG \[IRES\] \[JCOSAVE\] \[VERBOSEREC\] \[JCOSAVEITN\] \[REISAVEITN\] \[PARSAVEITN\] \[PARSAVERUN\]
\* sensitivity reuse
SENRELTHRESH SENMAXREUSE
SENALLCALCINT SENPREDWEIGHT SENPIEXCLUDE
\* singular value decomposition
SVDMODE
MAXSING EIGTHRESH
EIGWRITE
\* lsqr
LSQRMODE
LSQR_ATOL LSQR_BTOL LSQR_CONLIM LSQR_ITNLIM
LSQRWRITE
\* automatic user intervention
MAXAUI AUISTARTOPT NOAUIPHIRAT AUIRESTITN
AUISENSRAT AUIHOLDMAXCHG AUINUMFREE
AUIPHIRATSUF AUIPHIRATACCEPT NAUINOACCEPT
\* svd assist
BASEPESTFILE
BASEJACFILE
SVDA_MULBPA SVDA_SCALADJ SVDA_EXTSUPER SVDA_SUPDERCALC SVDA_PAR_EXCL
\* parameter groups
PARGPNME INCTYP DERINC DERINCLB FORCEN DERINCMUL DERMTHD \[SPLITTHRESH SPLITRELDIFF SPLITACTION\]
(*one such line for each of NPARGP parameter groups*)
\* parameter data
PARNME PARTRANS PARCHGLIM PARVAL1 PARLBND PARUBND PARGP SCALE OFFSET DERCOM
(*one such line for each of NPAR parameters*)
PARNME PARTIED
(*one such line for each tied parameter*)
\* observation groups
OBGNME \[GTARG\] \[COVFLE\]
(*one such line for each of NOBSGP observation group*)
\* observation data
OBSNME OBSVAL WEIGHT OBGNME
(*one such line for each of NOBS observations*)
\* derivatives command line
DERCOMLINE
EXTDERFLE
\* model command line
COMLINE
(*one such line for each of NUMCOM command lines*)
\* model input/output
TEMPFLE INFLE
(*one such line for each of NTPLFLE template files*)
INSFLE OUTFLE
(*one such line for each of NINSLFE instruction files*)
\* prior information
PILBL PIFAC \* PARNME + PIFAC \* log(PARNME) ... = PIVAL WEIGHT OBGNME
(*one such line for each of NPRIOR articles of prior information*)
\* predictive analysis
NPREDMAXMIN \[PREDNOISE\]
PD0 PD1 PD2
ABSPREDLAM RELPREDLAM INITSCHFAC MULSCHFAC NSEARCH
ABSPREDSWH RELPREDSWH
NPREDNORED ABSPREDSTP RELPREDSTP NPREDSTP
\* regularization
PHIMLIM PHIMACCEPT \[FRACPHIM\] \[MEMSAVE\]
WFINIT WFMIN WFMAX \[LINREG\] \[REGCONTINUE\]
WFFAC WFTOL IREGADJ \[NOPTREGADJ REGWEIGHTRAT \[REGSINGTHRESH\]\]
\* pareto
PARETO_OBSGROUP
PARETO_WTFAC_START PARETO_WTFAC_FIN NUM_WTFAC_INC
NUM_ITER_START NUM_ITER_GEN NUM_ITER_FIN
ALT_TERM
OBS_TERM ABOVE_OR_BELOW OBS_THRESH NUM_ITER_THRESH (*only if ALT_TERM is non-zero*)
NOBS_REPORT
OBS_REPORT_1 OBS_REPORT_2 OBS_REPORT_3.. (*NOBS_REPORT items*)
Table A1.1 Variables in the “control data” section of the PEST control file.
| Variable   | Type     | Values                                                 | Description                                                                                                                 |
|----------------|--------------|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| RSTFLE         | text         | “restart” or “norestart”                                   | instructs PEST whether to write restart data                                                                                    |
| PESTMODE       | text         | “estimation”, “prediction”, “regularization”, “pareto”     | PEST’s mode of operation                                                                                                        |

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 
- **Subsection:** 

### Additional Summaries
- **Higher-Level Summary:** 
- **Detailed Summary:** 

### Related Context
- **Previous Summary:** This document cites: Ahlfeld and Mulligan (2000), Alfonso and Oliver (2019), Campolongo et al. (2005), Chan (1994), Charnes and Cooper (1959), Chen and Oliver (2013, 2016), Coello et al. (2004), Doherty (2015, 2018a, 2018b), Doherty and Hunt (2009), Doherty and Welter (2010), Duan (1991), Duan et al. (1992, 1993, 1994), Eberhart and Kennedy (1995), Emerick and Reynolds (2013), Engelbrecht (2007), Evensen (2003), Evans and Moshonov (2006), Fienen et al. (2010), Forrest et al. (2016), Hadi (1992), Hantush and Marino (1989), Hill and Tiedeman (2007), Homma and Saltelli (1996), Kennedy (1998), Koch (1999), Lougee-Heimer (2003), Luo et al. (2018), Miller and Wagner (1965), Moore et al. (2010), Morris (1991), Oliver et al. (2008), Paige and Saunders (1982a, 1982b), Remy et al. (2011), Saltelli et al. (2004, 2008), Schafer and Strimmer (2005), Siade et al. (2019), Sobol (2001), Storn and Price (1995, 1997), Tung (1986), and Wagner and Gorelick (1987).
- **Next Summary:** These are the control variables in the "control data" section.  All are optional with defaults;  some are used only by PEST.  PEST++ uses "++" prefixed keywords.  Integer variables (except NPRIOR) must be >0.  Real variables have specific ranges.  The latest variables are on the PEST++ website.  Parallel run variables (section 5.3.6) are not included.

### Metadata
- **Keywords:** * control data, * model command line, * model input/output, * observation data, * observation groups, * parameter data, * parameter groups, * prior information, * regularization, * singular value decomposition, ABOVE_OR_BELOW, ABSPREDLAM, ABSPREDSTP, ABSPREDSWH, ALT_TERM, AUIHOLDMAXCHG, AUINUMFREE, AUIPHIRATACCEPT, AUIPHIRATSUF, AUIRESTITN, AUISENSRAT, AUISTARTOPT, BASEJACFILE, BASEPESTFILE, BOUNDSCALE, COMLINE, DERCOM, DERCOMLINE, DERFORGIVE, DERINC, DERINCLB, DERINCMUL, DERMTHD, DOAUI, DOSENREUSE, DPOINT, EIGTHRESH, EIGWRITE, EXTDERFLE, FACORIG, FACPARMAX, FORCEN, FRACPHIM, GTARG, IBOUNDSTICK, ICOR, ICOV, IEIG, INCTYP, INFLE, INITSCHFAC, INSFLE, IREGADJ, IRES, JACFILE, JACUPDATE, JCOSAVE, JCOSAVEITN, LAMFORGIVE, LASTRUN, LINREG, LSQRMODE, LSQR_ATOL, LSQR_BTOL, LSQR_CONLIM, LSQR_ITNLIM, MAXAUI, MAXCOMPDIM, MAXSING, MEMSAVE, MESSFILE, MULSCHFAC, NAUINOACCEPT, NINSFLE, NOAUIPHIRAT, NOBS, NOBSGP, NOBS_REPORT, NOPTMAX, NOPTREGADJ, NOPTSWITCH, NPAR, NPARGP, NPHINORED, NPHISTP, NPREDMAXMIN, NPREDNORED, NPREDSTP, NPRIOR, NRELPAR, NSEARCH, NTPLFLE, NUMCOM, NUMLAM, NUM_ITER_FIN, NUM_ITER_GEN, NUM_ITER_START, OBGNME, OBSNME, OBSREREF, OBSVAL, OBS_TERM, OBS_THRESH, OFFSET, OUTFLE, PARCHGLIM, PARETO_OBSGROUP, PARETO_WTFAC_FIN, PARETO_WTFAC_START, PARGP, PARGPNME, PARLBND, PARNME, PARSAVEITN, PARSAVERUN, PARTIED, PARTRANS, PARUBND, PARVAL1, PD0, PD1, PD2, PESTMODE, PHIABANDON, PHIMACCEPT, PHIMLIM, PHIRATSUF, PHIREDLAM, PHIREDSTP, PHIREDSWH, PHISTOPTHRESH, PIFAC, PILBL, PIVAL, PRECIS, PREDNOISE, REGCONTINUE, REGSINGTHRESH, REGWEIGHTRAT, REISAVEITN, RELPARMAX, RELPARSTP, RELPREDLAM, RELPREDSTP, RELPREDSWH, RLAMBDA1, RLAMFAC, RSTFLE, SCALE, SENALLCALCINT, SENMAXREUSE, SENPIEXCLUDE, SENPREDWEIGHT, SENRELTHRESH, SPLITACTION, SPLITRELDIFF, SPLITSWH, SPLITTHRESH, SVDA_EXTSUPER, SVDA_MULBPA, SVDA_PAR_EXCL, SVDA_SCALADJ, SVDA_SUPDERCALC, SVDMODE, TEMPFLE, UPVECBEND, VERBOSEREC, WFFAC, WFINIT, WFMAX, WFMIN, WFTOL
- **Chunk ID:** 36260bc07205
- **Chunk Index:** 2
- **Previous Chunk ID:** 6ec92fa30597
- **Next Chunk ID:** ec06f012104f

---

## Context

### Summary
**case.rei (interim residuals file) contains observation names, groups, measured and modeled values, residuals, and weights (or "Cov. Mat.") per iteration.  case.mtt (matrix file) contains covariance, correlation, eigenvector, and eigenvalue matrices (if ICOV, ICOR, IEIG=1, no regularization, JtQJ invertible).  The condition number file (JtQJ + λI) is created if SVD or LSQR are not used.  REISAVEITN saves multiple case.rei files.**

### Header
**4.19.2 Format of a Covariance Matrix File**

### Content
Because a new set of “rotated observations” is calculated for members of this group, the user-assigned names for the original observations are no longer applicable. Hence when PEST lists the names of the new observations to this file, it formulates new observation names by adding the string “_r” to the names of the original observations. However it is important to note that a rotated observation whose name is formulated by adding the string “_r” to the name of an original observation has no more of a direct relationship to that original observation than it does to any other member of the original observation group; this observation naming convention is just a convenience.
5.3.6 Interim Residuals File
At the beginning of each iteration PEST writes a file named case.rei where case is the filename base of the PEST control file. This file is a “temporary” or “interim” residuals file. It contains six columns of data. The first two columns cite observation names and group names; then follow observation values (supplied by the user) and their current model-generated counterparts. Current residuals and weights follow that in subsequent columns.
The following should be noted.
1. Model-generated observations recorded in the residuals file pertain to the best parameters calculated at the stage of the parameter estimation process at which the interim residuals file is written.
2. If an observation belongs to a group for which a covariance matrix is supplied, then a weight cannot be assigned to it. Hence, in accordance with the convention adopted for the residuals file case.res recorded at the end of the parameter estimation process, the string “Cov. Mat” is recorded in place of a weight.
3. As is explained in chapter 9 of this manual, weights pertaining to members of regularisation groups change throughout the inversion process. Hence these weights are different for different case.rei files recorded at different stages of a regularised inversion process.
5.3.7 The Matrix File
During each iteration, just after it has calculated the Jacobian matrix, PEST calculates the “post-calibration” covariance and correlation coefficient matrices, as well as the eigenvalues.
and normalised eigenvectors of the covariance matrix, for the current set of parameter values. However this only happens if the following conditions are met.
- ICOV, ICOR and IEIG are set to 1 in the “control data” section of the PEST control file;
- No form or regularisation is employed (as the use regularisation renders these matrices meaningless); hence neither singular value decomposition nor LSQR is used to solve the inverse problem, and Tikhonov regularisation is not employed;
- The matrix JtQJ is invertible, where J is the Jacobian matrix and Q is the weight matrix.
These matrices are written to a special file named a “matrix file”. This file is named case.mtt where case is the current case name (i.e. the filename base of the PEST control file). Each time this file is written the previous file of the same name is overwritten. Hence the matrices contained in the matrix file pertain to the most recent iteration.
If any of ICOV, ICOR or IEIG are set to zero, the corresponding matrix is not recorded in the matrix file. If they are all set to zero, then no matrices are written to this file. If ICOV is set to 1 then, as well as recording the covariance matrix to the matrix file, PEST records current parameter values and standard deviations. (The standard deviation of a parameter is the square root of its variance; parameter variances comprise the diagonal elements of the covariance matrix.) As with the elements of the covariance and associated matrices, the standard deviation of a parameter actually pertains to the log of that parameter if the parameter is log-transformed during the parameter estimation process.
The observant PEST user may notice slight differences between the matrices recorded in the final matrix file and those recorded in the run record file at the end of the PEST run. If the lowest objective function achieved during the parameter estimation process was calculated by PEST during its final iteration, then you may expect that these two sets of matrices will be very similar. Nevertheless, there are often differences between them. These differences result from the fact that the reference variance (see equation 5.3.3) used in calculation of matrices which are recorded in the matrix file is computed using the objective function calculated at the end of the previous iteration, whereas for the covariance and related matrices recorded in the run record file, the best objective function calculated during the whole parameter estimation process is used in computing the reference variance. If the best objective function was computed on the final parameter upgrade, this will differ slightly from that calculated at the beginning of the last iteration.
5.3.8 The Condition Number File
Unless PEST is using singular value decomposition or LSQR for solution of the inverse problem, it writes the condition number of the matrix which it must invert to calculate parameter upgrades (i.e. JtQJ + λI) to a “condition number file”. The condition number is recorded for every Marquardt lambda tested during every PEST iteration.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.19 Covariance Matrix Files

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** COVFLE specifies covariance matrix files for observation groups, overriding individual weights. PEST supports various ASCII covariance matrix file formats. Different PEST versions may produce varied results for ill-posed problems. PEST run commands include switches for different functionalities and modes. Parameter estimation results include objective function, estimates, confidence limits, observations, and statistics.

### Related Context
- **Previous Summary:** High composite observation sensitivity doesn't guarantee indispensability; redundant observations may exist.  case.res (residuals file) lists observations, model values, residuals, weighted values, standard deviations, and natural weights (Equation 5.3.3).  case.rsr (rotated residuals file) is created if covariance matrices are used (Equation 5.3.4, 5.3.5, 5.3.6, 5.3.7, 5.3.8).
- **Next Summary:** case.cnd (condition number file) shows the condition number of JtQJ + λI per lambda; high values ( >10⁴) indicate ill-conditioning. case.svd (if EIGWRITE=1) contains singular values and vectors. case.lsq (if LSQRWRITE=1) contains LSQR solver information. case.rmf (Parallel PEST/BEOPEST) records run management.  case.par.N, case.pod, case.ppd are Pareto outputs. case.jco contains the Jacobian matrix. case.rsd (if IRES≠0) is a resolution data file for regularized inversions.  Restart files are created if RSTFLE=1 (Appendix B).  pest###.dap and pest###.dao are used for parallel runs.  Screen output shows run-time information.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG
- **Chunk ID:** e07ce6d00912
- **Chunk Index:** 16
- **Previous Chunk ID:** 90888f2b32df
- **Next Chunk ID:** 3618d458f5da

---

```

# System Prompt
```

You are a **PEST Documentation Expert**, specializing in:
- PEST documentation analysis
- Parameter estimation
- Model calibration
- Groundwater modeling

🔹 **Response Guidelines**
- **Always provide a direct answer first.**
- ** Please use Markdown format. Use line breaks to separate sections.**
- **Use only the provided documentation.**
- **If the answer isn't in the documentation, say so explicitly.**
- **Always include exactly 5 follow-up questions at the end.**

---

Explain the PEST parameter "{query}" using **this exact structure**:

1) **Definition**  
   - Provide a concise definition.  
   - Cite source(s) in the format: "File: [filename], Section: [header]" wherever applicable.

2) **Possible Values**  
   - Describe valid or recognized values (including defaults, if specified).  
   - Cite source(s).

3) **Implications**  
   - Explain the consequences or usage considerations for each value.  
   - If no direct implications are stated in the documentation, write: "Information not available in the provided content. I don’t know."

4) **Practical Usage Notes**  
   - Only include usage notes or examples if explicitly provided by the content.  
   - If none exist, write: "No usage notes found in the provided content. I don’t know."

5) **Keywords**  
   - List any keywords associated with this parameter as found in the documentation.  
   - If no keywords are provided, write: "No keywords found in the provided content. I don’t know."

6) **Follow-up References**  
   - Point out additional references or relevant sections from the documentation.

After your main answer, provide **exactly 5 follow-up questions**, numbered 1 to 5, which help the user explore this parameter further.  
- Each question must reference at least one specific section from the documentation if it exists.  
- If the documentation does not provide any relevant section or detail, explicitly state: "Information not available in the provided content. I don’t know."

**Important Notes**:  
- Do not mention internal processes, “chunks,” or retrieval steps.  
- If any part of the requested information is missing from the provided documents, **explicitly state**: "Information not available in the provided content. I don’t know."  
- Be concise, accurate, and do not invent details or assumptions.  
- Use the sources provided in `{context}` only, with the citation format "File: [filename], Section: [header]".

**Available Documentation with Metadata**:  
{context}

Please analyze the question and provide a comprehensive answer **strictly** following this structure.


```

# Full User Message
```

Question: What is ICOR?

Please provide a clear and concise answer **using only the information from the documentation below**. Follow these rules:

1. **Cite sources** as "File: [filename], Section: [header]" wherever you reference specific information.
2. **Include relevant examples** from the documentation, if present.
3. **Note any limitations or uncertainties** when the documentation is incomplete or ambiguous.
4. **Suggest related topics** or sections for further follow-up, if applicable.
5. After your main answer, provide **exactly 5 follow-up questions**, numbered 1 to 5, which help the user explore this topic further.
   - Each question must reference at least one specific section from the documentation if it exists.
   - If the documentation does not provide any relevant section or detail, explicitly state: "Information not available in the provided content. I don’t know."
6. **Include a Keywords section** if the topic is a parameter, listing any associated keywords as found in the documentation. If none exist, state: "No keywords found in the provided content. I don’t know."
7. Do not mention internal processes, “chunks,” or retrieval steps.
8. If any part of the requested information is missing from the provided documents, explicitly state: "Information not available in the provided content. I don’t know."
9. Be concise, accurate, and do not invent details or assumptions.

**Available Documentation with Metadata**:
# Search Results for: What is ICOR?

Keywords: icor

## Variations
1. What does ICOR refer to?
2. Could you describe what ICOR is?
3. Please explain what ICOR is.
4. Can you clarify what ICOR signifies?
5. What signifies ICOR?


## Context

### Summary
**ICOV, ICOR, IEIG (0 or 1) control writing of covariance, correlation, and eigenvector matrices to a matrix file. IRES (0 or 1) controls writing of a resolution data file (case.rsd). JCOSAVE ("jcosave" or "nojcosave") controls Jacobian matrix file (case.jco) saving. JCOSAVEITN ("jcosaveitn" or "nojcosaveitn") saves a JCO file for each iteration. VERBOSEREC ("verboserec" or "noverboserec") controls run record file verbosity.**

### Header
**4.2.10 Ninth Line**

### Content
ICOV, ICOR and IEIG
If PEST is run in “estimation” mode, and if neither singular value decomposition nor LSQR is employed in solution of the inverse problem, then at the end of each iteration of the inversion process PEST can write a “matrix file” containing linear estimates of the posterior covariance and correlation coefficient matrices, as well as eigenvectors and eigenvalues of the posterior covariance matrix. Calculation of these matrices is based on the current Jacobian matrix. Settings of the ICOV, ICOR and IEIG variables determine which (if any) of these data are recorded in the matrix file. A setting of 1 for each of these variables will result in the corresponding information being recorded. On the other hand, a setting of 0 will result in the corresponding information not being recorded. Regardless of these settings, all of these matrices are recorded on the run record file at the end of the inversion process (provided, once again, that PEST is not run in “regularisation” mode and that neither singular value decomposition nor LSQR is used to solve the inverse problem.)
The posterior covariance matrix, together with its correlation coefficients and eigenvectors/eigenvalues, can be used to examine the “health” of an inverse problem in which regularisation is purely manual and therefore implied in the definition of the parameters themselves. This covariance matrix is computed using equation 5.2.13 of Doherty (2015). Note, however, that these matrices cannot be computed if an inverse problem is completely ill-posed.
A better way to compute a posterior covariance matrix is to use the PREDUNC7 utility; this is not troubled by problem ill-posedness. Other linear parameter and predictive uncertainty analysis possibilities are available through utilities discussed in part II of this manual. Furthermore, with mathematical regularisation in place, the information provided by eigenvector decomposition of the posterior covariance matrix, and by parameter correlation coefficients computed from this matrix, is not really needed, for the mathematical regularisation process, instead of the user, takes care of possible inverse problem ill-posedness. See Doherty (2015) for details.
IRES
This is an integer variable which controls the writing of a “resolution data file”. This is a binary file which is used by utilities such as RESPROC, RESWRIT and PARAMERR which compute the resolution matrix, and quantify post-calibration predictive error variance. The resolution data file is automatically named case.rsd, where case is the filename base of the PEST control file.
If omitted, IRES is set to 1. Writing of a resolution data file can therefore only be prevented if IRES is included in the PEST control file and specifically set to 0. This is its recommended setting, as the utility programs which use it are less informative than more recent programs such as those comprising the PREDVAR* and PREDUNC* suites which have superseded them; the latter programs do not read a resolution data file.
JCOSAVE
This optional text variable can be used to suppress recording of the binary Jacobian matrix file (i.e. JCO file). If supplied, it must be provided as “jcosave” or “nojcosave”. If omitted,
“jcosave” prevails. This variable can be placed anywhere following the mandatory IEIG or optional IRES variable on the ninth line of the “control data” section of the PEST control file. Its recommended value is “jcosave”, unless the inverse problem size is very large indeed and the MAXCOMPDIM variable has been employed to activate internal compressed Jacobian matrix storage; in the latter case the accessing of a large Jacobian matrix for the purpose of recording a JCO file can be computationally intensive.
JCOSAVEITN
JCOSAVEITN is an optional character variable which should be supplied as either “jcosaveitn” or “nojcosaveitn”. If the former string is supplied, PEST writes a JCO file at the end of every iteration, this containing the Jacobian matrix calculated during that iteration. The name of each such file is case.jco.N where N is the iteration number to which the JCO file pertains. Alternatively, if JCOSAVEITN is set to “nojcosaveitn”, or omitted altogether, PEST will not save a progression of JCO files in this manner. Note that the JCO file containing the Jacobian matrix corresponding to the best parameter set attained so far is saved to a file named case.jco in the usual manner, regardless of the setting of JCOSAVEITN. The JCOSAVEITN variable can be placed anywhere on the ninth line of the “control data” section of the PEST control file following ICOV, ICOR, IEIG and, optionally, IRES. JCOSAVEITN should be set to “jcosaveitn” if it is desired that the MULJCOSEN utility be employed for monitoring of changes to composite parameter and/or observation sensitivities during the inversion process. See part II of this manual for a description of this utility.
VERBOSEREC
Where parameter, observation and prior information numbers are high, the PEST run record file becomes voluminous - so voluminous that it is almost impossible for a user to obtain useful information from it. PEST will write a much shorter run record file if VERBOSEREC (a text variable) is set to “noverboserec”. The default value for this variable (i.e. the value that will prevail if it is not supplied at all) is “verboserec”. The VERBOSEREC variable can be placed anywhere following ICOV, ICOR, IEIG and, optionally, IRES on the ninth line of the “control data” section of the PEST control file.
REISAVEITN

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** PHISTOPTHRESH, PHIABANDON, and LASTRUN control null space Monte Carlo.  PHIABANDON (high value or file) stops calibration if the objective function is too high; LASTRUN (0 or 1) controls the final model run.  A PHIABANDON schedule file provides iteration-specific thresholds.  If the objective function exceeds the threshold, the parameter adjustment process is abandoned.
- **Next Summary:** REISAVEITN ("reisaveitn" or "noreisaveitn") controls saving interim residuals files (case.rei, case.rei.N). PARSAVEITN ("parsaveitn" or "noparsaveitn") saves parameter values (case.par.N) per iteration. PARSAVERUN ("parsaverun" or "noparsaverun") saves run-specific parameter values (BEOPEST only, case.par.N_M).  An optional "sensitivity reuse" section (Chapter 7) governs sensitivity reuse.  An optional "singular value decomposition" section is recommended for most applications.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG, IRES, JCOSAVE, JCOSAVEITN, MAXCOMPDIM, REISAVEITN, VERBOSEREC
- **Chunk ID:** 626d16643148
- **Chunk Index:** 1
- **Previous Chunk ID:** 421e7b0896aa
- **Next Chunk ID:** 70b3867d696b

---

## Context

### Summary
**EIGPROC summarizes information from case.rec and case.sen files.  It requires PESTMODE="estimation", ICOV=ICOR=IEIG=1,  a completed or "stop with statistics" run, and a well-posed problem (invertible JtQJ matrix). Use `eigproc case`.**

### Header
**8.2.1 General**

### Content
EIGPROC reads a PEST run record file and a PEST sensitivity file. It extracts and summarises information from these files. Recall that a PEST run record file is always named case.rec where case is the filename base of the PEST control file; a sensitivity file is named case.sen.
Use of EIGPROC (which stands for “eigenstuff processor”) is predicated on the following assumptions.
- PEST has been run in “estimation” mode.
- The ICOV, ICOR and IEIG variables in the “control data” section of the PEST control file are all set to 1.
- PEST has run to completion, or has been stopped using the “stop with statistics option”. (This will happen if the PSTOPST program has been run in another window).
- The parameter estimation problem is well posed so that the JtQJ matrix (often referred to as the “normal matrix”) inverted by PEST to obtain the parameter covariance matrix is not singular; thus a post‑calibration covariance matrix (and associated correlation coefficient and eigendata matrices) are recorded at the end of the run record file.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software
- **Main Section:** 8. PEST Statistical Postprocessing
- **Subsection:** 8.2 EIGPROC

### Additional Summaries
- **Higher-Level Summary:** In "predictive analysis" mode, PEST optimizes predictions while maintaining the objective function below a threshold, considering post-calibration uncertainty. It requires accurate derivatives, a prior calibration process, and parameter consistency with the estimation run. Users can adjust Marquardt lambda, search parameters, and incorporate predictive noise for improved analysis.
- **Detailed Summary:** In "predictive analysis" mode, PEST maximizes/minimizes a prediction (in the "predict" group) while keeping the objective function ≤ Φ0 (requires a prior "estimation" run).  It uses the same parameters, transformations, and observations as the estimation run.  Restarting uses `/r`, `/j`, `/d`, or `/s` (parallel runs).  Change limits remain important.  Screen output shows prediction values per iteration.  Results include the optimal prediction and parameter values.

### Related Context
- **Previous Summary:** This chapter details post-PEST run utilities analyzing calibration dataset information content and parameter estimability.  Some utilities (EIGPROC, PCOV2MAT, INFSTAT, INFSTAT1) are for well-posed problems; others (SUPCALC, IDENTPAR, SSSTAT) handle ill-posed problems.  GENLINPRED (analyzes prediction uncertainties, separate chapter) provides further insights.
- **Next Summary:** EIGPROC analyzes the parameter covariance matrix from a PEST run record file (case.rec) and sensitivity file (case.sen), requiring a well-posed "estimation" mode run (ICOV=ICOR=IEIG=1). Use `eigproc case N exlim outfile`: case specifies the control file, N is the number of eigenvalues, exlim is the eigenvector component threshold, and outfile is the output file.  Output includes eigenvalues, eigenvectors (components >exlim), sensitivities, and a correlation coefficient submatrix.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG
- **Chunk ID:** 5e652b0adadc
- **Chunk Index:** 1
- **Previous Chunk ID:** c5265fbb0e72
- **Next Chunk ID:** cf26a67b407b

---

## Context

### Summary
**ICOV, ICOR, and IEIG (integers) in the "control data" section are not used by PESTPP-GLM. Set them to 0 for PESTCHEK compatibility.**

### Header
**4.6.10 Ninth Line**

### Content
The integer ICOV, ICOR and IEIG variables recorded on the 9th line of the control data section of a PEST control file are not used by any members of the PESTPP-GLM suite. Set all of these to 0 for PESTCHEK-friendliness.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.6 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** The optional "automatic user intervention" section (section 6.3) governs automatic user intervention, activated by setting DOAUI to "doaui" in the "control data" section.  If omitted, default values are used.

### Related Context
- **Previous Summary:** NOPTMAX (integer, 50 recommended) sets maximum iterations; 0 runs one model; -1 or -2 generates a JCO file.  PESTPP-GLM uses PHIREDSTP (real, 0.005), NPHISTP (integer, 4), NPHINORED (integer, 4), RELPARSTP (real, 0.005), and NRELPAR (integer, 4) for termination; PESTPP-IES uses all except RELPARSTP and NRELPAR. Other PEST++ programs use only NOPTMAX.
- **Next Summary:** PESTPP-GLM uses SVD for inversion, with settings overridable via a "singular value decomposition" section (MAXSING, EIGTHRESH). MAXSING directly sets dimensionality; EIGTHRESH sets it implicitly (ratio of squared singular values of Q½J).  Omit this section to use PESTPP-GLM defaults.  MAXSING should equal or exceed the number of parameters unless dimensionality reduction is desired.  *max_n_super*/ *super_eigthresh* (PEST++) control super parameter numbers in SVD-assisted inversion;  MAXSING/EIGTHRESH control SVD regardless of base/super parameter estimation.  PESTPP-IES and PESTPP-DA also use internal SVD defaults, which are overridden if the "singular value decomposition" section is present.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG
- **Chunk ID:** e93b50160cd8
- **Chunk Index:** 1
- **Previous Chunk ID:** cbb14971764f
- **Next Chunk ID:** 1815f651636e

---

## Context

### Summary
**This appendix specifies the PEST control file format (Figure A1.1).  Variables are position-based, space/tab-delimited; strings with spaces are quoted.  Blank lines and comments (#) are allowed (PEST versions ≥15).  Optional variables are in brackets.  PEST++ uses "++" prefixed keywords; PEST ignores these.  The first line is "pcf".**

### Header
**14. References**

### Content
Wagner, B.J. and Gorelick, S.M., 1987. Optimal groundwater quality management under parameter uncertainty. *Water. Resour. Res.* 23(7), 1162-1174.
Welter, D.E., Doherty, J.E., Hunt, R.J., Muffels, C.T., Tonkin, M.J., and Schreüder, W.A., 2012. Approaches in highly parameterized inversion - PEST++, a Parameter ESTimation code optimized for large environmental models: U.S. Geological Survey Techniques and Methods, book 7, section C5, 47 p., available at .
Welter, D.E., White, J.T., Hunt, R.J., and Doherty, J.E., 2015. [Approaches in highly parameterized inversion: PEST++ Version 3, a Parameter ESTimation and uncertainty analysis software suite optimized for large environmental models](https://pubs.er.usgs.gov/publication/tm7C12). U.S. Geological Survey Techniques and Methods, book 7, section C12, 54 p.
White, J.T., 2018. A model-independent iterative ensemble smoother for efficient history-matching and uncertainty quantification in very high dimensions. Accepted for publication in *Environmental Modelling and Software*.
White, J.T., Fienen, M.N., Barlow, P.M. and Welter, D.E., 2018. A tool for efficient, model-independent management optimization under uncertainty. *Environmental Modelling and Software*, 100, 213-221.
White, J.T., Fienen, M.N. and Doherty, J.E., 2016. A Python framework for environmental model uncertainty analysis. *Environmental Modelling and Software*, 85, 217-228.
White, J.T., Doherty, J.E. and Hughes, J.D., 2014. Quantifying the predictive consequences of model error with linear subspace analysis. *Water Resour. Res*. 50 (2): 1152-1173. DOI: 10.1002/2013WR014767
Zhang, J., Lin, G., Li, W., Wu, L., & Zeng, L. (2018). An iterative local updating ensemble smoother for estimation and uncertainty assessment of hydrologic model parameters with multimodal distributions. *Water Resources Research*, 54, 1716– 1733.
**Appendix**
This appendix provides specifications for a PEST control file.
Variables are recognized by their position in the file. They must be placed on the correct line of this file and separated from their neighbours by at least one space.
PEST, BEOPEST and many of the PEST-support utility programs which are documented in part II of the PEST manual tolerate the presence of the following items in a PEST control file:
- blank lines;
- comments;
- lines that begin with the character string “++”.
Lines that begin with “++” are used for the insertion of variables which control the operation of the PEST++ suite of programs.
Comments can be placed on their own line. Alternatively, they can be placed at the end of a line which provides PEST control data. In either case, a comment follows a “#” character. Note, however, that this character is not construed as denoting the presence of an ensuing comment under any of the following circumstances:
- it is not preceded by a space, tab or the beginning of a line;
- it is part of a string that is enclosed in quotes.
These exceptions preclude mis-construing the presence of the “#” character in a filename as signifying the start of a comment.
Some of the older utilities that are documented in part II of the PEST manual do not tolerate the presence of blank lines, “++” lines or comments. All of these items can be removed from a PEST control file using the PSTCLEAN utility supplied with the PEST suite.
Figure A1.1 Names and locations of variables in the PEST control file. Optional variables are enclosed in square brackets.
pcf
\* control data
RSTFLE PESTMODE
NPAR NOBS NPARGP NPRIOR NOBSGP \[MAXCOMPDIM\]\[DERZEROLIM\]
NTPLFLE NINSFLE PRECIS DPOINT \[NUMCOM JACFILE MESSFILE\] \[OBSREREF\]
RLAMBDA1 RLAMFAC PHIRATSUF PHIREDLAM NUMLAM \[JACUPDATE\] \[LAMFORGIVE\] \[DERFORGIVE\]
RELPARMAX FACPARMAX FACORIG \[IBOUNDSTICK UPVECBEND\] \[ABSPARMAX\]
PHIREDSWH \[NOPTSWITCH\] \[SPLITSWH\] \[DOAUI\] \[DOSENREUSE\] \[BOUNDSCALE\]
NOPTMAX PHIREDSTP NPHISTP NPHINORED RELPARSTP NRELPAR \[PHISTOPTHRESH\] \[LASTRUN\] \[PHIABANDON\]
ICOV ICOR IEIG \[IRES\] \[JCOSAVE\] \[VERBOSEREC\] \[JCOSAVEITN\] \[REISAVEITN\] \[PARSAVEITN\] \[PARSAVERUN\]
\* sensitivity reuse
SENRELTHRESH SENMAXREUSE
SENALLCALCINT SENPREDWEIGHT SENPIEXCLUDE
\* singular value decomposition
SVDMODE
MAXSING EIGTHRESH
EIGWRITE
\* lsqr
LSQRMODE
LSQR_ATOL LSQR_BTOL LSQR_CONLIM LSQR_ITNLIM
LSQRWRITE
\* automatic user intervention
MAXAUI AUISTARTOPT NOAUIPHIRAT AUIRESTITN
AUISENSRAT AUIHOLDMAXCHG AUINUMFREE
AUIPHIRATSUF AUIPHIRATACCEPT NAUINOACCEPT
\* svd assist
BASEPESTFILE
BASEJACFILE
SVDA_MULBPA SVDA_SCALADJ SVDA_EXTSUPER SVDA_SUPDERCALC SVDA_PAR_EXCL
\* parameter groups
PARGPNME INCTYP DERINC DERINCLB FORCEN DERINCMUL DERMTHD \[SPLITTHRESH SPLITRELDIFF SPLITACTION\]
(*one such line for each of NPARGP parameter groups*)
\* parameter data
PARNME PARTRANS PARCHGLIM PARVAL1 PARLBND PARUBND PARGP SCALE OFFSET DERCOM
(*one such line for each of NPAR parameters*)
PARNME PARTIED
(*one such line for each tied parameter*)
\* observation groups
OBGNME \[GTARG\] \[COVFLE\]
(*one such line for each of NOBSGP observation group*)
\* observation data
OBSNME OBSVAL WEIGHT OBGNME
(*one such line for each of NOBS observations*)
\* derivatives command line
DERCOMLINE
EXTDERFLE
\* model command line
COMLINE
(*one such line for each of NUMCOM command lines*)
\* model input/output
TEMPFLE INFLE
(*one such line for each of NTPLFLE template files*)
INSFLE OUTFLE
(*one such line for each of NINSLFE instruction files*)
\* prior information
PILBL PIFAC \* PARNME + PIFAC \* log(PARNME) ... = PIVAL WEIGHT OBGNME
(*one such line for each of NPRIOR articles of prior information*)
\* predictive analysis
NPREDMAXMIN \[PREDNOISE\]
PD0 PD1 PD2
ABSPREDLAM RELPREDLAM INITSCHFAC MULSCHFAC NSEARCH
ABSPREDSWH RELPREDSWH
NPREDNORED ABSPREDSTP RELPREDSTP NPREDSTP
\* regularization
PHIMLIM PHIMACCEPT \[FRACPHIM\] \[MEMSAVE\]
WFINIT WFMIN WFMAX \[LINREG\] \[REGCONTINUE\]
WFFAC WFTOL IREGADJ \[NOPTREGADJ REGWEIGHTRAT \[REGSINGTHRESH\]\]
\* pareto
PARETO_OBSGROUP
PARETO_WTFAC_START PARETO_WTFAC_FIN NUM_WTFAC_INC
NUM_ITER_START NUM_ITER_GEN NUM_ITER_FIN
ALT_TERM
OBS_TERM ABOVE_OR_BELOW OBS_THRESH NUM_ITER_THRESH (*only if ALT_TERM is non-zero*)
NOBS_REPORT
OBS_REPORT_1 OBS_REPORT_2 OBS_REPORT_3.. (*NOBS_REPORT items*)
Table A1.1 Variables in the “control data” section of the PEST control file.
| Variable   | Type     | Values                                                 | Description                                                                                                                 |
|----------------|--------------|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| RSTFLE         | text         | “restart” or “norestart”                                   | instructs PEST whether to write restart data                                                                                    |
| PESTMODE       | text         | “estimation”, “prediction”, “regularization”, “pareto”     | PEST’s mode of operation                                                                                                        |

### Source
- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis
- **Main Section:** 
- **Subsection:** 

### Additional Summaries
- **Higher-Level Summary:** 
- **Detailed Summary:** 

### Related Context
- **Previous Summary:** This document cites: Ahlfeld and Mulligan (2000), Alfonso and Oliver (2019), Campolongo et al. (2005), Chan (1994), Charnes and Cooper (1959), Chen and Oliver (2013, 2016), Coello et al. (2004), Doherty (2015, 2018a, 2018b), Doherty and Hunt (2009), Doherty and Welter (2010), Duan (1991), Duan et al. (1992, 1993, 1994), Eberhart and Kennedy (1995), Emerick and Reynolds (2013), Engelbrecht (2007), Evensen (2003), Evans and Moshonov (2006), Fienen et al. (2010), Forrest et al. (2016), Hadi (1992), Hantush and Marino (1989), Hill and Tiedeman (2007), Homma and Saltelli (1996), Kennedy (1998), Koch (1999), Lougee-Heimer (2003), Luo et al. (2018), Miller and Wagner (1965), Moore et al. (2010), Morris (1991), Oliver et al. (2008), Paige and Saunders (1982a, 1982b), Remy et al. (2011), Saltelli et al. (2004, 2008), Schafer and Strimmer (2005), Siade et al. (2019), Sobol (2001), Storn and Price (1995, 1997), Tung (1986), and Wagner and Gorelick (1987).
- **Next Summary:** These are the control variables in the "control data" section.  All are optional with defaults;  some are used only by PEST.  PEST++ uses "++" prefixed keywords.  Integer variables (except NPRIOR) must be >0.  Real variables have specific ranges.  The latest variables are on the PEST++ website.  Parallel run variables (section 5.3.6) are not included.

### Metadata
- **Keywords:** * control data, * model command line, * model input/output, * observation data, * observation groups, * parameter data, * parameter groups, * prior information, * regularization, * singular value decomposition, ABOVE_OR_BELOW, ABSPREDLAM, ABSPREDSTP, ABSPREDSWH, ALT_TERM, AUIHOLDMAXCHG, AUINUMFREE, AUIPHIRATACCEPT, AUIPHIRATSUF, AUIRESTITN, AUISENSRAT, AUISTARTOPT, BASEJACFILE, BASEPESTFILE, BOUNDSCALE, COMLINE, DERCOM, DERCOMLINE, DERFORGIVE, DERINC, DERINCLB, DERINCMUL, DERMTHD, DOAUI, DOSENREUSE, DPOINT, EIGTHRESH, EIGWRITE, EXTDERFLE, FACORIG, FACPARMAX, FORCEN, FRACPHIM, GTARG, IBOUNDSTICK, ICOR, ICOV, IEIG, INCTYP, INFLE, INITSCHFAC, INSFLE, IREGADJ, IRES, JACFILE, JACUPDATE, JCOSAVE, JCOSAVEITN, LAMFORGIVE, LASTRUN, LINREG, LSQRMODE, LSQR_ATOL, LSQR_BTOL, LSQR_CONLIM, LSQR_ITNLIM, MAXAUI, MAXCOMPDIM, MAXSING, MEMSAVE, MESSFILE, MULSCHFAC, NAUINOACCEPT, NINSFLE, NOAUIPHIRAT, NOBS, NOBSGP, NOBS_REPORT, NOPTMAX, NOPTREGADJ, NOPTSWITCH, NPAR, NPARGP, NPHINORED, NPHISTP, NPREDMAXMIN, NPREDNORED, NPREDSTP, NPRIOR, NRELPAR, NSEARCH, NTPLFLE, NUMCOM, NUMLAM, NUM_ITER_FIN, NUM_ITER_GEN, NUM_ITER_START, OBGNME, OBSNME, OBSREREF, OBSVAL, OBS_TERM, OBS_THRESH, OFFSET, OUTFLE, PARCHGLIM, PARETO_OBSGROUP, PARETO_WTFAC_FIN, PARETO_WTFAC_START, PARGP, PARGPNME, PARLBND, PARNME, PARSAVEITN, PARSAVERUN, PARTIED, PARTRANS, PARUBND, PARVAL1, PD0, PD1, PD2, PESTMODE, PHIABANDON, PHIMACCEPT, PHIMLIM, PHIRATSUF, PHIREDLAM, PHIREDSTP, PHIREDSWH, PHISTOPTHRESH, PIFAC, PILBL, PIVAL, PRECIS, PREDNOISE, REGCONTINUE, REGSINGTHRESH, REGWEIGHTRAT, REISAVEITN, RELPARMAX, RELPARSTP, RELPREDLAM, RELPREDSTP, RELPREDSWH, RLAMBDA1, RLAMFAC, RSTFLE, SCALE, SENALLCALCINT, SENMAXREUSE, SENPIEXCLUDE, SENPREDWEIGHT, SENRELTHRESH, SPLITACTION, SPLITRELDIFF, SPLITSWH, SPLITTHRESH, SVDA_EXTSUPER, SVDA_MULBPA, SVDA_PAR_EXCL, SVDA_SCALADJ, SVDA_SUPDERCALC, SVDMODE, TEMPFLE, UPVECBEND, VERBOSEREC, WFFAC, WFINIT, WFMAX, WFMIN, WFTOL
- **Chunk ID:** 36260bc07205
- **Chunk Index:** 2
- **Previous Chunk ID:** 6ec92fa30597
- **Next Chunk ID:** ec06f012104f

---

## Context

### Summary
**case.rei (interim residuals file) contains observation names, groups, measured and modeled values, residuals, and weights (or "Cov. Mat.") per iteration.  case.mtt (matrix file) contains covariance, correlation, eigenvector, and eigenvalue matrices (if ICOV, ICOR, IEIG=1, no regularization, JtQJ invertible).  The condition number file (JtQJ + λI) is created if SVD or LSQR are not used.  REISAVEITN saves multiple case.rei files.**

### Header
**4.19.2 Format of a Covariance Matrix File**

### Content
Because a new set of “rotated observations” is calculated for members of this group, the user-assigned names for the original observations are no longer applicable. Hence when PEST lists the names of the new observations to this file, it formulates new observation names by adding the string “_r” to the names of the original observations. However it is important to note that a rotated observation whose name is formulated by adding the string “_r” to the name of an original observation has no more of a direct relationship to that original observation than it does to any other member of the original observation group; this observation naming convention is just a convenience.
5.3.6 Interim Residuals File
At the beginning of each iteration PEST writes a file named case.rei where case is the filename base of the PEST control file. This file is a “temporary” or “interim” residuals file. It contains six columns of data. The first two columns cite observation names and group names; then follow observation values (supplied by the user) and their current model-generated counterparts. Current residuals and weights follow that in subsequent columns.
The following should be noted.
1. Model-generated observations recorded in the residuals file pertain to the best parameters calculated at the stage of the parameter estimation process at which the interim residuals file is written.
2. If an observation belongs to a group for which a covariance matrix is supplied, then a weight cannot be assigned to it. Hence, in accordance with the convention adopted for the residuals file case.res recorded at the end of the parameter estimation process, the string “Cov. Mat” is recorded in place of a weight.
3. As is explained in chapter 9 of this manual, weights pertaining to members of regularisation groups change throughout the inversion process. Hence these weights are different for different case.rei files recorded at different stages of a regularised inversion process.
5.3.7 The Matrix File
During each iteration, just after it has calculated the Jacobian matrix, PEST calculates the “post-calibration” covariance and correlation coefficient matrices, as well as the eigenvalues.
and normalised eigenvectors of the covariance matrix, for the current set of parameter values. However this only happens if the following conditions are met.
- ICOV, ICOR and IEIG are set to 1 in the “control data” section of the PEST control file;
- No form or regularisation is employed (as the use regularisation renders these matrices meaningless); hence neither singular value decomposition nor LSQR is used to solve the inverse problem, and Tikhonov regularisation is not employed;
- The matrix JtQJ is invertible, where J is the Jacobian matrix and Q is the weight matrix.
These matrices are written to a special file named a “matrix file”. This file is named case.mtt where case is the current case name (i.e. the filename base of the PEST control file). Each time this file is written the previous file of the same name is overwritten. Hence the matrices contained in the matrix file pertain to the most recent iteration.
If any of ICOV, ICOR or IEIG are set to zero, the corresponding matrix is not recorded in the matrix file. If they are all set to zero, then no matrices are written to this file. If ICOV is set to 1 then, as well as recording the covariance matrix to the matrix file, PEST records current parameter values and standard deviations. (The standard deviation of a parameter is the square root of its variance; parameter variances comprise the diagonal elements of the covariance matrix.) As with the elements of the covariance and associated matrices, the standard deviation of a parameter actually pertains to the log of that parameter if the parameter is log-transformed during the parameter estimation process.
The observant PEST user may notice slight differences between the matrices recorded in the final matrix file and those recorded in the run record file at the end of the PEST run. If the lowest objective function achieved during the parameter estimation process was calculated by PEST during its final iteration, then you may expect that these two sets of matrices will be very similar. Nevertheless, there are often differences between them. These differences result from the fact that the reference variance (see equation 5.3.3) used in calculation of matrices which are recorded in the matrix file is computed using the objective function calculated at the end of the previous iteration, whereas for the covariance and related matrices recorded in the run record file, the best objective function calculated during the whole parameter estimation process is used in computing the reference variance. If the best objective function was computed on the final parameter upgrade, this will differ slightly from that calculated at the beginning of the last iteration.
5.3.8 The Condition Number File
Unless PEST is using singular value decomposition or LSQR for solution of the inverse problem, it writes the condition number of the matrix which it must invert to calculate parameter upgrades (i.e. JtQJ + λI) to a “condition number file”. The condition number is recorded for every Marquardt lambda tested during every PEST iteration.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.19 Covariance Matrix Files

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** COVFLE specifies covariance matrix files for observation groups, overriding individual weights. PEST supports various ASCII covariance matrix file formats. Different PEST versions may produce varied results for ill-posed problems. PEST run commands include switches for different functionalities and modes. Parameter estimation results include objective function, estimates, confidence limits, observations, and statistics.

### Related Context
- **Previous Summary:** High composite observation sensitivity doesn't guarantee indispensability; redundant observations may exist.  case.res (residuals file) lists observations, model values, residuals, weighted values, standard deviations, and natural weights (Equation 5.3.3).  case.rsr (rotated residuals file) is created if covariance matrices are used (Equation 5.3.4, 5.3.5, 5.3.6, 5.3.7, 5.3.8).
- **Next Summary:** case.cnd (condition number file) shows the condition number of JtQJ + λI per lambda; high values ( >10⁴) indicate ill-conditioning. case.svd (if EIGWRITE=1) contains singular values and vectors. case.lsq (if LSQRWRITE=1) contains LSQR solver information. case.rmf (Parallel PEST/BEOPEST) records run management.  case.par.N, case.pod, case.ppd are Pareto outputs. case.jco contains the Jacobian matrix. case.rsd (if IRES≠0) is a resolution data file for regularized inversions.  Restart files are created if RSTFLE=1 (Appendix B).  pest###.dap and pest###.dao are used for parallel runs.  Screen output shows run-time information.

### Metadata
- **Keywords:** ICOR, ICOV, IEIG
- **Chunk ID:** e07ce6d00912
- **Chunk Index:** 16
- **Previous Chunk ID:** 90888f2b32df
- **Next Chunk ID:** 3618d458f5da

---


Please analyze the question and provide a comprehensive answer **strictly** following the above rules.

```

# Complete Messages Array
```json
[
  {
    "role": "system",
    "content": "\nYou are a **PEST Documentation Expert**, specializing in:\n- PEST documentation analysis\n- Parameter estimation\n- Model calibration\n- Groundwater modeling\n\n🔹 **Response Guidelines**\n- **Always provide a direct answer first.**\n- ** Please use Markdown format. Use line breaks to separate sections.**\n- **Use only the provided documentation.**\n- **If the answer isn't in the documentation, say so explicitly.**\n- **Always include exactly 5 follow-up questions at the end.**\n\n---\n\nExplain the PEST parameter \"{query}\" using **this exact structure**:\n\n1) **Definition**  \n   - Provide a concise definition.  \n   - Cite source(s) in the format: \"File: [filename], Section: [header]\" wherever applicable.\n\n2) **Possible Values**  \n   - Describe valid or recognized values (including defaults, if specified).  \n   - Cite source(s).\n\n3) **Implications**  \n   - Explain the consequences or usage considerations for each value.  \n   - If no direct implications are stated in the documentation, write: \"Information not available in the provided content. I don’t know.\"\n\n4) **Practical Usage Notes**  \n   - Only include usage notes or examples if explicitly provided by the content.  \n   - If none exist, write: \"No usage notes found in the provided content. I don’t know.\"\n\n5) **Keywords**  \n   - List any keywords associated with this parameter as found in the documentation.  \n   - If no keywords are provided, write: \"No keywords found in the provided content. I don’t know.\"\n\n6) **Follow-up References**  \n   - Point out additional references or relevant sections from the documentation.\n\nAfter your main answer, provide **exactly 5 follow-up questions**, numbered 1 to 5, which help the user explore this parameter further.  \n- Each question must reference at least one specific section from the documentation if it exists.  \n- If the documentation does not provide any relevant section or detail, explicitly state: \"Information not available in the provided content. I don’t know.\"\n\n**Important Notes**:  \n- Do not mention internal processes, “chunks,” or retrieval steps.  \n- If any part of the requested information is missing from the provided documents, **explicitly state**: \"Information not available in the provided content. I don’t know.\"  \n- Be concise, accurate, and do not invent details or assumptions.  \n- Use the sources provided in `{context}` only, with the citation format \"File: [filename], Section: [header]\".\n\n**Available Documentation with Metadata**:  \n{context}\n\nPlease analyze the question and provide a comprehensive answer **strictly** following this structure.\n\n"
  },
  {
    "role": "user",
    "content": "\nQuestion: What is ICOR?\n\nPlease provide a clear and concise answer **using only the information from the documentation below**. Follow these rules:\n\n1. **Cite sources** as \"File: [filename], Section: [header]\" wherever you reference specific information.\n2. **Include relevant examples** from the documentation, if present.\n3. **Note any limitations or uncertainties** when the documentation is incomplete or ambiguous.\n4. **Suggest related topics** or sections for further follow-up, if applicable.\n5. After your main answer, provide **exactly 5 follow-up questions**, numbered 1 to 5, which help the user explore this topic further.\n   - Each question must reference at least one specific section from the documentation if it exists.\n   - If the documentation does not provide any relevant section or detail, explicitly state: \"Information not available in the provided content. I don’t know.\"\n6. **Include a Keywords section** if the topic is a parameter, listing any associated keywords as found in the documentation. If none exist, state: \"No keywords found in the provided content. I don’t know.\"\n7. Do not mention internal processes, “chunks,” or retrieval steps.\n8. If any part of the requested information is missing from the provided documents, explicitly state: \"Information not available in the provided content. I don’t know.\"\n9. Be concise, accurate, and do not invent details or assumptions.\n\n**Available Documentation with Metadata**:\n# Search Results for: What is ICOR?\n\nKeywords: icor\n\n## Variations\n1. What does ICOR refer to?\n2. Could you describe what ICOR is?\n3. Please explain what ICOR is.\n4. Can you clarify what ICOR signifies?\n5. What signifies ICOR?\n\n\n## Context\n\n### Summary\n**ICOV, ICOR, IEIG (0 or 1) control writing of covariance, correlation, and eigenvector matrices to a matrix file. IRES (0 or 1) controls writing of a resolution data file (case.rsd). JCOSAVE (\"jcosave\" or \"nojcosave\") controls Jacobian matrix file (case.jco) saving. JCOSAVEITN (\"jcosaveitn\" or \"nojcosaveitn\") saves a JCO file for each iteration. VERBOSEREC (\"verboserec\" or \"noverboserec\") controls run record file verbosity.**\n\n### Header\n**4.2.10 Ninth Line**\n\n### Content\nICOV, ICOR and IEIG\nIf PEST is run in “estimation” mode, and if neither singular value decomposition nor LSQR is employed in solution of the inverse problem, then at the end of each iteration of the inversion process PEST can write a “matrix file” containing linear estimates of the posterior covariance and correlation coefficient matrices, as well as eigenvectors and eigenvalues of the posterior covariance matrix. Calculation of these matrices is based on the current Jacobian matrix. Settings of the ICOV, ICOR and IEIG variables determine which (if any) of these data are recorded in the matrix file. A setting of 1 for each of these variables will result in the corresponding information being recorded. On the other hand, a setting of 0 will result in the corresponding information not being recorded. Regardless of these settings, all of these matrices are recorded on the run record file at the end of the inversion process (provided, once again, that PEST is not run in “regularisation” mode and that neither singular value decomposition nor LSQR is used to solve the inverse problem.)\nThe posterior covariance matrix, together with its correlation coefficients and eigenvectors/eigenvalues, can be used to examine the “health” of an inverse problem in which regularisation is purely manual and therefore implied in the definition of the parameters themselves. This covariance matrix is computed using equation 5.2.13 of Doherty (2015). Note, however, that these matrices cannot be computed if an inverse problem is completely ill-posed.\nA better way to compute a posterior covariance matrix is to use the PREDUNC7 utility; this is not troubled by problem ill-posedness. Other linear parameter and predictive uncertainty analysis possibilities are available through utilities discussed in part II of this manual. Furthermore, with mathematical regularisation in place, the information provided by eigenvector decomposition of the posterior covariance matrix, and by parameter correlation coefficients computed from this matrix, is not really needed, for the mathematical regularisation process, instead of the user, takes care of possible inverse problem ill-posedness. See Doherty (2015) for details.\nIRES\nThis is an integer variable which controls the writing of a “resolution data file”. This is a binary file which is used by utilities such as RESPROC, RESWRIT and PARAMERR which compute the resolution matrix, and quantify post-calibration predictive error variance. The resolution data file is automatically named case.rsd, where case is the filename base of the PEST control file.\nIf omitted, IRES is set to 1. Writing of a resolution data file can therefore only be prevented if IRES is included in the PEST control file and specifically set to 0. This is its recommended setting, as the utility programs which use it are less informative than more recent programs such as those comprising the PREDVAR* and PREDUNC* suites which have superseded them; the latter programs do not read a resolution data file.\nJCOSAVE\nThis optional text variable can be used to suppress recording of the binary Jacobian matrix file (i.e. JCO file). If supplied, it must be provided as “jcosave” or “nojcosave”. If omitted,\n“jcosave” prevails. This variable can be placed anywhere following the mandatory IEIG or optional IRES variable on the ninth line of the “control data” section of the PEST control file. Its recommended value is “jcosave”, unless the inverse problem size is very large indeed and the MAXCOMPDIM variable has been employed to activate internal compressed Jacobian matrix storage; in the latter case the accessing of a large Jacobian matrix for the purpose of recording a JCO file can be computationally intensive.\nJCOSAVEITN\nJCOSAVEITN is an optional character variable which should be supplied as either “jcosaveitn” or “nojcosaveitn”. If the former string is supplied, PEST writes a JCO file at the end of every iteration, this containing the Jacobian matrix calculated during that iteration. The name of each such file is case.jco.N where N is the iteration number to which the JCO file pertains. Alternatively, if JCOSAVEITN is set to “nojcosaveitn”, or omitted altogether, PEST will not save a progression of JCO files in this manner. Note that the JCO file containing the Jacobian matrix corresponding to the best parameter set attained so far is saved to a file named case.jco in the usual manner, regardless of the setting of JCOSAVEITN. The JCOSAVEITN variable can be placed anywhere on the ninth line of the “control data” section of the PEST control file following ICOV, ICOR, IEIG and, optionally, IRES. JCOSAVEITN should be set to “jcosaveitn” if it is desired that the MULJCOSEN utility be employed for monitoring of changes to composite parameter and/or observation sensitivities during the inversion process. See part II of this manual for a description of this utility.\nVERBOSEREC\nWhere parameter, observation and prior information numbers are high, the PEST run record file becomes voluminous - so voluminous that it is almost impossible for a user to obtain useful information from it. PEST will write a much shorter run record file if VERBOSEREC (a text variable) is set to “noverboserec”. The default value for this variable (i.e. the value that will prevail if it is not supplied at all) is “verboserec”. The VERBOSEREC variable can be placed anywhere following ICOV, ICOR, IEIG and, optionally, IRES on the ninth line of the “control data” section of the PEST control file.\nREISAVEITN\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers\n- **Main Section:** 4. The PEST Control File\n- **Subsection:** 4.2 Control Data Section\n\n### Additional Summaries\n- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.\n- **Detailed Summary:** Figure 4.2 shows \"control data\" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be \"* control data\";  some variables are optional (in brackets).\n\n### Related Context\n- **Previous Summary:** PHISTOPTHRESH, PHIABANDON, and LASTRUN control null space Monte Carlo.  PHIABANDON (high value or file) stops calibration if the objective function is too high; LASTRUN (0 or 1) controls the final model run.  A PHIABANDON schedule file provides iteration-specific thresholds.  If the objective function exceeds the threshold, the parameter adjustment process is abandoned.\n- **Next Summary:** REISAVEITN (\"reisaveitn\" or \"noreisaveitn\") controls saving interim residuals files (case.rei, case.rei.N). PARSAVEITN (\"parsaveitn\" or \"noparsaveitn\") saves parameter values (case.par.N) per iteration. PARSAVERUN (\"parsaverun\" or \"noparsaverun\") saves run-specific parameter values (BEOPEST only, case.par.N_M).  An optional \"sensitivity reuse\" section (Chapter 7) governs sensitivity reuse.  An optional \"singular value decomposition\" section is recommended for most applications.\n\n### Metadata\n- **Keywords:** ICOR, ICOV, IEIG, IRES, JCOSAVE, JCOSAVEITN, MAXCOMPDIM, REISAVEITN, VERBOSEREC\n- **Chunk ID:** 626d16643148\n- **Chunk Index:** 1\n- **Previous Chunk ID:** 421e7b0896aa\n- **Next Chunk ID:** 70b3867d696b\n\n---\n\n## Context\n\n### Summary\n**EIGPROC summarizes information from case.rec and case.sen files.  It requires PESTMODE=\"estimation\", ICOV=ICOR=IEIG=1,  a completed or \"stop with statistics\" run, and a well-posed problem (invertible JtQJ matrix). Use `eigproc case`.**\n\n### Header\n**8.2.1 General**\n\n### Content\nEIGPROC reads a PEST run record file and a PEST sensitivity file. It extracts and summarises information from these files. Recall that a PEST run record file is always named case.rec where case is the filename base of the PEST control file; a sensitivity file is named case.sen.\nUse of EIGPROC (which stands for “eigenstuff processor”) is predicated on the following assumptions.\n- PEST has been run in “estimation” mode.\n- The ICOV, ICOR and IEIG variables in the “control data” section of the PEST control file are all set to 1.\n- PEST has run to completion, or has been stopped using the “stop with statistics option”. (This will happen if the PSTOPST program has been run in another window).\n- The parameter estimation problem is well posed so that the JtQJ matrix (often referred to as the “normal matrix”) inverted by PEST to obtain the parameter covariance matrix is not singular; thus a post‑calibration covariance matrix (and associated correlation coefficient and eigendata matrices) are recorded at the end of the run record file.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software\n- **Main Section:** 8. PEST Statistical Postprocessing\n- **Subsection:** 8.2 EIGPROC\n\n### Additional Summaries\n- **Higher-Level Summary:** In \"predictive analysis\" mode, PEST optimizes predictions while maintaining the objective function below a threshold, considering post-calibration uncertainty. It requires accurate derivatives, a prior calibration process, and parameter consistency with the estimation run. Users can adjust Marquardt lambda, search parameters, and incorporate predictive noise for improved analysis.\n- **Detailed Summary:** In \"predictive analysis\" mode, PEST maximizes/minimizes a prediction (in the \"predict\" group) while keeping the objective function ≤ Φ0 (requires a prior \"estimation\" run).  It uses the same parameters, transformations, and observations as the estimation run.  Restarting uses `/r`, `/j`, `/d`, or `/s` (parallel runs).  Change limits remain important.  Screen output shows prediction values per iteration.  Results include the optimal prediction and parameter values.\n\n### Related Context\n- **Previous Summary:** This chapter details post-PEST run utilities analyzing calibration dataset information content and parameter estimability.  Some utilities (EIGPROC, PCOV2MAT, INFSTAT, INFSTAT1) are for well-posed problems; others (SUPCALC, IDENTPAR, SSSTAT) handle ill-posed problems.  GENLINPRED (analyzes prediction uncertainties, separate chapter) provides further insights.\n- **Next Summary:** EIGPROC analyzes the parameter covariance matrix from a PEST run record file (case.rec) and sensitivity file (case.sen), requiring a well-posed \"estimation\" mode run (ICOV=ICOR=IEIG=1). Use `eigproc case N exlim outfile`: case specifies the control file, N is the number of eigenvalues, exlim is the eigenvector component threshold, and outfile is the output file.  Output includes eigenvalues, eigenvectors (components >exlim), sensitivities, and a correlation coefficient submatrix.\n\n### Metadata\n- **Keywords:** ICOR, ICOV, IEIG\n- **Chunk ID:** 5e652b0adadc\n- **Chunk Index:** 1\n- **Previous Chunk ID:** c5265fbb0e72\n- **Next Chunk ID:** cf26a67b407b\n\n---\n\n## Context\n\n### Summary\n**ICOV, ICOR, and IEIG (integers) in the \"control data\" section are not used by PESTPP-GLM. Set them to 0 for PESTCHEK compatibility.**\n\n### Header\n**4.6.10 Ninth Line**\n\n### Content\nThe integer ICOV, ICOR and IEIG variables recorded on the 9th line of the control data section of a PEST control file are not used by any members of the PESTPP-GLM suite. Set all of these to 0 for PESTCHEK-friendliness.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis\n- **Main Section:** 4. The PEST Control File\n- **Subsection:** 4.6 Control Data Section\n\n### Additional Summaries\n- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.\n- **Detailed Summary:** The optional \"automatic user intervention\" section (section 6.3) governs automatic user intervention, activated by setting DOAUI to \"doaui\" in the \"control data\" section.  If omitted, default values are used.\n\n### Related Context\n- **Previous Summary:** NOPTMAX (integer, 50 recommended) sets maximum iterations; 0 runs one model; -1 or -2 generates a JCO file.  PESTPP-GLM uses PHIREDSTP (real, 0.005), NPHISTP (integer, 4), NPHINORED (integer, 4), RELPARSTP (real, 0.005), and NRELPAR (integer, 4) for termination; PESTPP-IES uses all except RELPARSTP and NRELPAR. Other PEST++ programs use only NOPTMAX.\n- **Next Summary:** PESTPP-GLM uses SVD for inversion, with settings overridable via a \"singular value decomposition\" section (MAXSING, EIGTHRESH). MAXSING directly sets dimensionality; EIGTHRESH sets it implicitly (ratio of squared singular values of Q½J).  Omit this section to use PESTPP-GLM defaults.  MAXSING should equal or exceed the number of parameters unless dimensionality reduction is desired.  *max_n_super*/ *super_eigthresh* (PEST++) control super parameter numbers in SVD-assisted inversion;  MAXSING/EIGTHRESH control SVD regardless of base/super parameter estimation.  PESTPP-IES and PESTPP-DA also use internal SVD defaults, which are overridden if the \"singular value decomposition\" section is present.\n\n### Metadata\n- **Keywords:** ICOR, ICOV, IEIG\n- **Chunk ID:** e93b50160cd8\n- **Chunk Index:** 1\n- **Previous Chunk ID:** cbb14971764f\n- **Next Chunk ID:** 1815f651636e\n\n---\n\n## Context\n\n### Summary\n**This appendix specifies the PEST control file format (Figure A1.1).  Variables are position-based, space/tab-delimited; strings with spaces are quoted.  Blank lines and comments (#) are allowed (PEST versions ≥15).  Optional variables are in brackets.  PEST++ uses \"++\" prefixed keywords; PEST ignores these.  The first line is \"pcf\".**\n\n### Header\n**14. References**\n\n### Content\nWagner, B.J. and Gorelick, S.M., 1987. Optimal groundwater quality management under parameter uncertainty. *Water. Resour. Res.* 23(7), 1162-1174.\nWelter, D.E., Doherty, J.E., Hunt, R.J., Muffels, C.T., Tonkin, M.J., and Schreüder, W.A., 2012. Approaches in highly parameterized inversion - PEST++, a Parameter ESTimation code optimized for large environmental models: U.S. Geological Survey Techniques and Methods, book 7, section C5, 47 p., available at .\nWelter, D.E., White, J.T., Hunt, R.J., and Doherty, J.E., 2015. [Approaches in highly parameterized inversion: PEST++ Version 3, a Parameter ESTimation and uncertainty analysis software suite optimized for large environmental models](https://pubs.er.usgs.gov/publication/tm7C12). U.S. Geological Survey Techniques and Methods, book 7, section C12, 54 p.\nWhite, J.T., 2018. A model-independent iterative ensemble smoother for efficient history-matching and uncertainty quantification in very high dimensions. Accepted for publication in *Environmental Modelling and Software*.\nWhite, J.T., Fienen, M.N., Barlow, P.M. and Welter, D.E., 2018. A tool for efficient, model-independent management optimization under uncertainty. *Environmental Modelling and Software*, 100, 213-221.\nWhite, J.T., Fienen, M.N. and Doherty, J.E., 2016. A Python framework for environmental model uncertainty analysis. *Environmental Modelling and Software*, 85, 217-228.\nWhite, J.T., Doherty, J.E. and Hughes, J.D., 2014. Quantifying the predictive consequences of model error with linear subspace analysis. *Water Resour. Res*. 50 (2): 1152-1173. DOI: 10.1002/2013WR014767\nZhang, J., Lin, G., Li, W., Wu, L., & Zeng, L. (2018). An iterative local updating ensemble smoother for estimation and uncertainty assessment of hydrologic model parameters with multimodal distributions. *Water Resources Research*, 54, 1716– 1733.\n**Appendix**\nThis appendix provides specifications for a PEST control file.\nVariables are recognized by their position in the file. They must be placed on the correct line of this file and separated from their neighbours by at least one space.\nPEST, BEOPEST and many of the PEST-support utility programs which are documented in part II of the PEST manual tolerate the presence of the following items in a PEST control file:\n- blank lines;\n- comments;\n- lines that begin with the character string “++”.\nLines that begin with “++” are used for the insertion of variables which control the operation of the PEST++ suite of programs.\nComments can be placed on their own line. Alternatively, they can be placed at the end of a line which provides PEST control data. In either case, a comment follows a “#” character. Note, however, that this character is not construed as denoting the presence of an ensuing comment under any of the following circumstances:\n- it is not preceded by a space, tab or the beginning of a line;\n- it is part of a string that is enclosed in quotes.\nThese exceptions preclude mis-construing the presence of the “#” character in a filename as signifying the start of a comment.\nSome of the older utilities that are documented in part II of the PEST manual do not tolerate the presence of blank lines, “++” lines or comments. All of these items can be removed from a PEST control file using the PSTCLEAN utility supplied with the PEST suite.\nFigure A1.1 Names and locations of variables in the PEST control file. Optional variables are enclosed in square brackets.\npcf\n\\* control data\nRSTFLE PESTMODE\nNPAR NOBS NPARGP NPRIOR NOBSGP \\[MAXCOMPDIM\\]\\[DERZEROLIM\\]\nNTPLFLE NINSFLE PRECIS DPOINT \\[NUMCOM JACFILE MESSFILE\\] \\[OBSREREF\\]\nRLAMBDA1 RLAMFAC PHIRATSUF PHIREDLAM NUMLAM \\[JACUPDATE\\] \\[LAMFORGIVE\\] \\[DERFORGIVE\\]\nRELPARMAX FACPARMAX FACORIG \\[IBOUNDSTICK UPVECBEND\\] \\[ABSPARMAX\\]\nPHIREDSWH \\[NOPTSWITCH\\] \\[SPLITSWH\\] \\[DOAUI\\] \\[DOSENREUSE\\] \\[BOUNDSCALE\\]\nNOPTMAX PHIREDSTP NPHISTP NPHINORED RELPARSTP NRELPAR \\[PHISTOPTHRESH\\] \\[LASTRUN\\] \\[PHIABANDON\\]\nICOV ICOR IEIG \\[IRES\\] \\[JCOSAVE\\] \\[VERBOSEREC\\] \\[JCOSAVEITN\\] \\[REISAVEITN\\] \\[PARSAVEITN\\] \\[PARSAVERUN\\]\n\\* sensitivity reuse\nSENRELTHRESH SENMAXREUSE\nSENALLCALCINT SENPREDWEIGHT SENPIEXCLUDE\n\\* singular value decomposition\nSVDMODE\nMAXSING EIGTHRESH\nEIGWRITE\n\\* lsqr\nLSQRMODE\nLSQR_ATOL LSQR_BTOL LSQR_CONLIM LSQR_ITNLIM\nLSQRWRITE\n\\* automatic user intervention\nMAXAUI AUISTARTOPT NOAUIPHIRAT AUIRESTITN\nAUISENSRAT AUIHOLDMAXCHG AUINUMFREE\nAUIPHIRATSUF AUIPHIRATACCEPT NAUINOACCEPT\n\\* svd assist\nBASEPESTFILE\nBASEJACFILE\nSVDA_MULBPA SVDA_SCALADJ SVDA_EXTSUPER SVDA_SUPDERCALC SVDA_PAR_EXCL\n\\* parameter groups\nPARGPNME INCTYP DERINC DERINCLB FORCEN DERINCMUL DERMTHD \\[SPLITTHRESH SPLITRELDIFF SPLITACTION\\]\n(*one such line for each of NPARGP parameter groups*)\n\\* parameter data\nPARNME PARTRANS PARCHGLIM PARVAL1 PARLBND PARUBND PARGP SCALE OFFSET DERCOM\n(*one such line for each of NPAR parameters*)\nPARNME PARTIED\n(*one such line for each tied parameter*)\n\\* observation groups\nOBGNME \\[GTARG\\] \\[COVFLE\\]\n(*one such line for each of NOBSGP observation group*)\n\\* observation data\nOBSNME OBSVAL WEIGHT OBGNME\n(*one such line for each of NOBS observations*)\n\\* derivatives command line\nDERCOMLINE\nEXTDERFLE\n\\* model command line\nCOMLINE\n(*one such line for each of NUMCOM command lines*)\n\\* model input/output\nTEMPFLE INFLE\n(*one such line for each of NTPLFLE template files*)\nINSFLE OUTFLE\n(*one such line for each of NINSLFE instruction files*)\n\\* prior information\nPILBL PIFAC \\* PARNME + PIFAC \\* log(PARNME) ... = PIVAL WEIGHT OBGNME\n(*one such line for each of NPRIOR articles of prior information*)\n\\* predictive analysis\nNPREDMAXMIN \\[PREDNOISE\\]\nPD0 PD1 PD2\nABSPREDLAM RELPREDLAM INITSCHFAC MULSCHFAC NSEARCH\nABSPREDSWH RELPREDSWH\nNPREDNORED ABSPREDSTP RELPREDSTP NPREDSTP\n\\* regularization\nPHIMLIM PHIMACCEPT \\[FRACPHIM\\] \\[MEMSAVE\\]\nWFINIT WFMIN WFMAX \\[LINREG\\] \\[REGCONTINUE\\]\nWFFAC WFTOL IREGADJ \\[NOPTREGADJ REGWEIGHTRAT \\[REGSINGTHRESH\\]\\]\n\\* pareto\nPARETO_OBSGROUP\nPARETO_WTFAC_START PARETO_WTFAC_FIN NUM_WTFAC_INC\nNUM_ITER_START NUM_ITER_GEN NUM_ITER_FIN\nALT_TERM\nOBS_TERM ABOVE_OR_BELOW OBS_THRESH NUM_ITER_THRESH (*only if ALT_TERM is non-zero*)\nNOBS_REPORT\nOBS_REPORT_1 OBS_REPORT_2 OBS_REPORT_3.. (*NOBS_REPORT items*)\nTable A1.1 Variables in the “control data” section of the PEST control file.\n| Variable   | Type     | Values                                                 | Description                                                                                                                 |\n|----------------|--------------|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|\n| RSTFLE         | text         | “restart” or “norestart”                                   | instructs PEST whether to write restart data                                                                                    |\n| PESTMODE       | text         | “estimation”, “prediction”, “regularization”, “pareto”     | PEST’s mode of operation                                                                                                        |\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation: PEST++ a Software Suite for Parameter Estimation, Uncertainty Analysis, Management Optimization and Sensitivity Analysis\n- **Main Section:** \n- **Subsection:** \n\n### Additional Summaries\n- **Higher-Level Summary:** \n- **Detailed Summary:** \n\n### Related Context\n- **Previous Summary:** This document cites: Ahlfeld and Mulligan (2000), Alfonso and Oliver (2019), Campolongo et al. (2005), Chan (1994), Charnes and Cooper (1959), Chen and Oliver (2013, 2016), Coello et al. (2004), Doherty (2015, 2018a, 2018b), Doherty and Hunt (2009), Doherty and Welter (2010), Duan (1991), Duan et al. (1992, 1993, 1994), Eberhart and Kennedy (1995), Emerick and Reynolds (2013), Engelbrecht (2007), Evensen (2003), Evans and Moshonov (2006), Fienen et al. (2010), Forrest et al. (2016), Hadi (1992), Hantush and Marino (1989), Hill and Tiedeman (2007), Homma and Saltelli (1996), Kennedy (1998), Koch (1999), Lougee-Heimer (2003), Luo et al. (2018), Miller and Wagner (1965), Moore et al. (2010), Morris (1991), Oliver et al. (2008), Paige and Saunders (1982a, 1982b), Remy et al. (2011), Saltelli et al. (2004, 2008), Schafer and Strimmer (2005), Siade et al. (2019), Sobol (2001), Storn and Price (1995, 1997), Tung (1986), and Wagner and Gorelick (1987).\n- **Next Summary:** These are the control variables in the \"control data\" section.  All are optional with defaults;  some are used only by PEST.  PEST++ uses \"++\" prefixed keywords.  Integer variables (except NPRIOR) must be >0.  Real variables have specific ranges.  The latest variables are on the PEST++ website.  Parallel run variables (section 5.3.6) are not included.\n\n### Metadata\n- **Keywords:** * control data, * model command line, * model input/output, * observation data, * observation groups, * parameter data, * parameter groups, * prior information, * regularization, * singular value decomposition, ABOVE_OR_BELOW, ABSPREDLAM, ABSPREDSTP, ABSPREDSWH, ALT_TERM, AUIHOLDMAXCHG, AUINUMFREE, AUIPHIRATACCEPT, AUIPHIRATSUF, AUIRESTITN, AUISENSRAT, AUISTARTOPT, BASEJACFILE, BASEPESTFILE, BOUNDSCALE, COMLINE, DERCOM, DERCOMLINE, DERFORGIVE, DERINC, DERINCLB, DERINCMUL, DERMTHD, DOAUI, DOSENREUSE, DPOINT, EIGTHRESH, EIGWRITE, EXTDERFLE, FACORIG, FACPARMAX, FORCEN, FRACPHIM, GTARG, IBOUNDSTICK, ICOR, ICOV, IEIG, INCTYP, INFLE, INITSCHFAC, INSFLE, IREGADJ, IRES, JACFILE, JACUPDATE, JCOSAVE, JCOSAVEITN, LAMFORGIVE, LASTRUN, LINREG, LSQRMODE, LSQR_ATOL, LSQR_BTOL, LSQR_CONLIM, LSQR_ITNLIM, MAXAUI, MAXCOMPDIM, MAXSING, MEMSAVE, MESSFILE, MULSCHFAC, NAUINOACCEPT, NINSFLE, NOAUIPHIRAT, NOBS, NOBSGP, NOBS_REPORT, NOPTMAX, NOPTREGADJ, NOPTSWITCH, NPAR, NPARGP, NPHINORED, NPHISTP, NPREDMAXMIN, NPREDNORED, NPREDSTP, NPRIOR, NRELPAR, NSEARCH, NTPLFLE, NUMCOM, NUMLAM, NUM_ITER_FIN, NUM_ITER_GEN, NUM_ITER_START, OBGNME, OBSNME, OBSREREF, OBSVAL, OBS_TERM, OBS_THRESH, OFFSET, OUTFLE, PARCHGLIM, PARETO_OBSGROUP, PARETO_WTFAC_FIN, PARETO_WTFAC_START, PARGP, PARGPNME, PARLBND, PARNME, PARSAVEITN, PARSAVERUN, PARTIED, PARTRANS, PARUBND, PARVAL1, PD0, PD1, PD2, PESTMODE, PHIABANDON, PHIMACCEPT, PHIMLIM, PHIRATSUF, PHIREDLAM, PHIREDSTP, PHIREDSWH, PHISTOPTHRESH, PIFAC, PILBL, PIVAL, PRECIS, PREDNOISE, REGCONTINUE, REGSINGTHRESH, REGWEIGHTRAT, REISAVEITN, RELPARMAX, RELPARSTP, RELPREDLAM, RELPREDSTP, RELPREDSWH, RLAMBDA1, RLAMFAC, RSTFLE, SCALE, SENALLCALCINT, SENMAXREUSE, SENPIEXCLUDE, SENPREDWEIGHT, SENRELTHRESH, SPLITACTION, SPLITRELDIFF, SPLITSWH, SPLITTHRESH, SVDA_EXTSUPER, SVDA_MULBPA, SVDA_PAR_EXCL, SVDA_SCALADJ, SVDA_SUPDERCALC, SVDMODE, TEMPFLE, UPVECBEND, VERBOSEREC, WFFAC, WFINIT, WFMAX, WFMIN, WFTOL\n- **Chunk ID:** 36260bc07205\n- **Chunk Index:** 2\n- **Previous Chunk ID:** 6ec92fa30597\n- **Next Chunk ID:** ec06f012104f\n\n---\n\n## Context\n\n### Summary\n**case.rei (interim residuals file) contains observation names, groups, measured and modeled values, residuals, and weights (or \"Cov. Mat.\") per iteration.  case.mtt (matrix file) contains covariance, correlation, eigenvector, and eigenvalue matrices (if ICOV, ICOR, IEIG=1, no regularization, JtQJ invertible).  The condition number file (JtQJ + λI) is created if SVD or LSQR are not used.  REISAVEITN saves multiple case.rei files.**\n\n### Header\n**4.19.2 Format of a Covariance Matrix File**\n\n### Content\nBecause a new set of “rotated observations” is calculated for members of this group, the user-assigned names for the original observations are no longer applicable. Hence when PEST lists the names of the new observations to this file, it formulates new observation names by adding the string “_r” to the names of the original observations. However it is important to note that a rotated observation whose name is formulated by adding the string “_r” to the name of an original observation has no more of a direct relationship to that original observation than it does to any other member of the original observation group; this observation naming convention is just a convenience.\n5.3.6 Interim Residuals File\nAt the beginning of each iteration PEST writes a file named case.rei where case is the filename base of the PEST control file. This file is a “temporary” or “interim” residuals file. It contains six columns of data. The first two columns cite observation names and group names; then follow observation values (supplied by the user) and their current model-generated counterparts. Current residuals and weights follow that in subsequent columns.\nThe following should be noted.\n1. Model-generated observations recorded in the residuals file pertain to the best parameters calculated at the stage of the parameter estimation process at which the interim residuals file is written.\n2. If an observation belongs to a group for which a covariance matrix is supplied, then a weight cannot be assigned to it. Hence, in accordance with the convention adopted for the residuals file case.res recorded at the end of the parameter estimation process, the string “Cov. Mat” is recorded in place of a weight.\n3. As is explained in chapter 9 of this manual, weights pertaining to members of regularisation groups change throughout the inversion process. Hence these weights are different for different case.rei files recorded at different stages of a regularised inversion process.\n5.3.7 The Matrix File\nDuring each iteration, just after it has calculated the Jacobian matrix, PEST calculates the “post-calibration” covariance and correlation coefficient matrices, as well as the eigenvalues.\nand normalised eigenvectors of the covariance matrix, for the current set of parameter values. However this only happens if the following conditions are met.\n- ICOV, ICOR and IEIG are set to 1 in the “control data” section of the PEST control file;\n- No form or regularisation is employed (as the use regularisation renders these matrices meaningless); hence neither singular value decomposition nor LSQR is used to solve the inverse problem, and Tikhonov regularisation is not employed;\n- The matrix JtQJ is invertible, where J is the Jacobian matrix and Q is the weight matrix.\nThese matrices are written to a special file named a “matrix file”. This file is named case.mtt where case is the current case name (i.e. the filename base of the PEST control file). Each time this file is written the previous file of the same name is overwritten. Hence the matrices contained in the matrix file pertain to the most recent iteration.\nIf any of ICOV, ICOR or IEIG are set to zero, the corresponding matrix is not recorded in the matrix file. If they are all set to zero, then no matrices are written to this file. If ICOV is set to 1 then, as well as recording the covariance matrix to the matrix file, PEST records current parameter values and standard deviations. (The standard deviation of a parameter is the square root of its variance; parameter variances comprise the diagonal elements of the covariance matrix.) As with the elements of the covariance and associated matrices, the standard deviation of a parameter actually pertains to the log of that parameter if the parameter is log-transformed during the parameter estimation process.\nThe observant PEST user may notice slight differences between the matrices recorded in the final matrix file and those recorded in the run record file at the end of the PEST run. If the lowest objective function achieved during the parameter estimation process was calculated by PEST during its final iteration, then you may expect that these two sets of matrices will be very similar. Nevertheless, there are often differences between them. These differences result from the fact that the reference variance (see equation 5.3.3) used in calculation of matrices which are recorded in the matrix file is computed using the objective function calculated at the end of the previous iteration, whereas for the covariance and related matrices recorded in the run record file, the best objective function calculated during the whole parameter estimation process is used in computing the reference variance. If the best objective function was computed on the final parameter upgrade, this will differ slightly from that calculated at the beginning of the last iteration.\n5.3.8 The Condition Number File\nUnless PEST is using singular value decomposition or LSQR for solution of the inverse problem, it writes the condition number of the matrix which it must invert to calculate parameter upgrades (i.e. JtQJ + λI) to a “condition number file”. The condition number is recorded for every Marquardt lambda tested during every PEST iteration.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers\n- **Main Section:** 4. The PEST Control File\n- **Subsection:** 4.19 Covariance Matrix Files\n\n### Additional Summaries\n- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.\n- **Detailed Summary:** COVFLE specifies covariance matrix files for observation groups, overriding individual weights. PEST supports various ASCII covariance matrix file formats. Different PEST versions may produce varied results for ill-posed problems. PEST run commands include switches for different functionalities and modes. Parameter estimation results include objective function, estimates, confidence limits, observations, and statistics.\n\n### Related Context\n- **Previous Summary:** High composite observation sensitivity doesn't guarantee indispensability; redundant observations may exist.  case.res (residuals file) lists observations, model values, residuals, weighted values, standard deviations, and natural weights (Equation 5.3.3).  case.rsr (rotated residuals file) is created if covariance matrices are used (Equation 5.3.4, 5.3.5, 5.3.6, 5.3.7, 5.3.8).\n- **Next Summary:** case.cnd (condition number file) shows the condition number of JtQJ + λI per lambda; high values ( >10⁴) indicate ill-conditioning. case.svd (if EIGWRITE=1) contains singular values and vectors. case.lsq (if LSQRWRITE=1) contains LSQR solver information. case.rmf (Parallel PEST/BEOPEST) records run management.  case.par.N, case.pod, case.ppd are Pareto outputs. case.jco contains the Jacobian matrix. case.rsd (if IRES≠0) is a resolution data file for regularized inversions.  Restart files are created if RSTFLE=1 (Appendix B).  pest###.dap and pest###.dao are used for parallel runs.  Screen output shows run-time information.\n\n### Metadata\n- **Keywords:** ICOR, ICOV, IEIG\n- **Chunk ID:** e07ce6d00912\n- **Chunk Index:** 16\n- **Previous Chunk ID:** 90888f2b32df\n- **Next Chunk ID:** 3618d458f5da\n\n---\n\n\nPlease analyze the question and provide a comprehensive answer **strictly** following the above rules.\n"
  }
]
```