# Stream Debug - 20250206_020031

# Original Question
```
What is npar?
```

# Context Content
```markdown
# Search Results for: What is npar?

Keywords: npar

## Variations
1. Can you explain what npar is?
2. What does npar refer to?
3. Could you describe what npar is?
4. Please clarify what npar means.
5. What is the definition of npar?


## Context

### Summary
**DERCOMB1 combines partial derivatives files into a complete external derivatives file (derfile2) for PEST. It uses a PEST control file (pestfile), a complete external derivatives file (derfile1, NOBS x NPAR), and a PEST matrix file (matfile, section 2.4) containing additional derivatives.  Matrix file derivatives replace those in derfile1, creating derfile2.  It's typically run within a model batch file. Use `DERCOMB1 pestfile matfile derfile1 derfile2`.**

### Header
**14.6.1 General**

### Content
“DERCOMB” stands for “derivatives combination”. The “1” suffix was included in the name of this utility in anticipation of the fact that it may not be the last utility written to perform a similar role. DERCOMB1 was written for use in calibration contexts where a model provides its own derivatives. As explained in chapter 12 of part I of this manual, these are read from an external derivatives file written by the model. This file can be of a compressed or uncompressed type.
Where a model run by PEST is comprised of different executable programs, each of which can compute derivatives of its own outputs with respect to some or all of the parameters involved in the current PEST run, then the derivatives file written by each of them will be incomplete. The role of DERCOMB1 is to build a complete derivatives file by combining such partial derivatives files.
DERCOMB1 must be provided with the names of two derivatives files. The first of these must be a standard PEST external derivatives file which is “complete” in the sense that its dimensions are NOBS×NPAR where NPAR and NOBS are the numbers of parameters and observations respectively employed by PEST. Such a file may have been produced, for example, by the ASENPROC Groundwater Data Utility program. Elements of the derivatives matrix that ASENPROC cannot compute are supplied with a dummy value of ‑1.11E33, this being PEST’s expected value for derivative matrix elements which have not been determined.
The second derivatives file must be in PEST matrix file format (see section 2.4 of this manual for specifications of this file type). A derivatives file in matrix format is written, for example, by the ZONE2VAR1 Groundwater Data Utility program. Like the first file, this file must also contain derivatives of model outputs with respect to parameters as its elements. However, unlike the first file, it is not necessary that all parameters and observations cited in the PEST control file be cited in this file. Thus the matrix can have dimensions that are smaller than NOBS×NPAR. The names of the observations and parameters to which the derivatives in this file pertain are provided as matrix row and column names respectively. Each one of these must correspond to an observation or parameter featured in the PEST control file for the current problem.
DERCOMB1 reads the first derivatives file, and then the second derivatives file. It verifies that the first has dimensions of NOBS×NPAR. (It does not check parameter and observation names in this file, as this file does not need to provide these; it is simply assumed that parameters and observations are represented in the same order in this file as they are represented in the PEST control file which defines the current inverse problem.)
14.6.2 Using DERCOMB1
DERCOMB1 then reads the matrix file. Each derivative represented in the matrix file then replaces the corresponding derivative represented in the external derivatives file. DERCOMB1 then writes a new external derivatives file with these modified derivatives.
DERCOMB1 is run using the command:
DERCOMB1 pestfile matfile derfile1 derfile2
where
- pestfile is the name of a PEST control file,
- matfile is the name of matrix file,
- derfile1 is the name of an existing external derivatives file, and
- derfile2 is the name of a new external derivatives file.
As stated above, the existing PEST external derivatives file must contain a derivatives matrix (represented in either full or compressed form) with dimensions of NOBS×NPAR, where NOBS is the number of observations cited in the PEST control file and NPAR is the number of parameters cited in this file. The matrix file must contain a matrix whose dimensions are equal to or less than these; however, all observations and parameters cited as row and column names in the matrix file must also be cited in the PEST control file (though not necessarily in the same order). DERCOMB1 replaces derivatives read from the existing external derivatives file with those read from the matrix file. It then writes a new external derivatives file with the upgraded derivatives. If the original derivatives file is supplied in compressed format, then the new derivatives file written by DERCOMB1 will also employ compressed format. (Note that DERCOMB1 does not read or write binary derivatives files.)
DERCOMB1 will normally be run as part of a model batch or script file cited in the “derivatives command line” section of a PEST control file. It will run after the model component that writes the external derivatives file as well as the model component that writes the matrix file of derivatives. Where there are many model executables and each of them calculate some of the derivatives required by PEST, DERCOMB1 may be run multiple times as part of the one model.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software
- **Main Section:** 14. Miscellaneous Utilities
- **Subsection:** 14.6 DERCOMB

### Additional Summaries
- **Higher-Level Summary:** Observation re-referencing simplifies derivative calculations by adjusting initial model conditions based on upgraded parameters, improving solver convergence time. It involves creating reference model outputs for accurate derivatives, with specific commands and activation steps. SVDAPREP and BEOPEST support this feature, enhancing model accuracy and efficiency.
- **Detailed Summary:** BEOPEST (but not Parallel PEST) supports observation re-referencing.  Adding "obsreref_N" to the "control data" section causes BEOPEST to complete re-referencing runs before starting Jacobian runs, pausing for N seconds afterwards. This ensures initial conditions are available for Jacobian runs, especially when copying initial condition files to agent directories.

### Related Context
- **Previous Summary:** PESTLIN linearizes a PEST dataset (pestincase.pst, .jco, .rec), creating a GENLIN dataset (linbasename.in, .out, .ins, .tpl) and a new PEST control file (pestoutcase.pst).  The `/d` switch enables external derivatives.  It handles tied parameters. Use `pestlin pestincase pestoutcase linbasename [/d]`.
- **Next Summary:** This chapter details PEST matrix file (section 2.4) manipulation utilities.  These utilities process matrices including Jacobian matrices, normal matrices, covariance matrices, and sensitivity vectors.  Chapter 5 describes JCO-to-matrix file conversion utilities (JCO2MAT, MAT2JCO, JROW2VEC, JROW2MAT).  Utilities are documented alphabetically.

### Metadata
- **Keywords:** NOBS, NPAR
- **Chunk ID:** e7a2cd220c27
- **Chunk Index:** 1
- **Previous Chunk ID:** fe9c86ccbde4
- **Next Chunk ID:** dcb2e352068d

---

## Context

### Summary
**If all derivatives are external (NDEP=NOBS), all DERCOM values should be 0. Otherwise, non-zero DERCOM values are needed for parameters requiring finite-difference derivatives.  Tied parameters require external derivatives for both the tied and parent parameters if either is in the derivatives interface file.  The "predict" group's observation placement is flexible in "predictive analysis" mode.  -1.11e33 is not needed; external derivatives can be supplied for fixed or adjustable parameters.**

### Header
**12.6.4 Special Considerations**

### Content
If DERCOM for a particular parameter is set to zero in the “parameter data” section of the PEST control file, this informs PEST that no finite-difference derivatives calculation with respect to that parameter is required; that is, the derivatives of all observations with respect to that parameter are supplied by the model. If this is the case, the NDEP variable in the derivatives interface file must be equal to NOBS – the total number of observations. On the other hand, if NDEP is not set to NOBS in a particular derivatives interface file, this indicates that there are some observations for all parameters for which derivatives must be calculated by finite differences, and hence DERCOM must be set to a non-zero value (normally 1) for each parameter.
If NDEP is equal to NOBS, and NPAR in the derivatives interface file is not equal to NPAR in the PEST control file (i.e. the total number of parameters), then parameters are effectively subdivided into two groups – those for which derivatives for all observations are supplied by the model, and those for which derivatives for all observations must be calculated by finite differences. DERCOM for all of the former parameters must be set to zero; for all of the latter parameters it must be set to an appropriate non-zero value. If NDEP is equal to NOBS, and NPAR in the derivatives interface file is equal to NPAR in the PEST control file (i.e. the total number of cited parameters), then all parameters should have a DERCOM value of zero.
Special considerations apply to tied parameters. The tied parameter is not adjusted, but instead maintains the same ratio with the parent parameter as that supplied through initial parameter values; derivatives of parent parameters are adjusted to accommodate the existence of one or more tied parameters.
If a decision is made to tie a parameter to a parent parameter in the PEST control file, no alterations are required to the derivatives interface file. However certain ties are forbidden. In particular, a parameter cited in a derivatives interface file can only be tied to a parameter that is also cited in the derivatives interface file. This rule ensures that there will be no observations for which derivatives with respect to a tied parameter are calculated by the model while derivatives with respect to the parent parameter are calculated by finite differences. The reverse of this rule also applies. That is, a parameter that is not cited in the derivatives interface file cannot be tied to a parameter that is cited within this file. This will rarely be a harsh restriction, for normally it is only parameters that are similar to each other that are tied to each other; derivatives with respect to similar parameters are normally calculated by similar means. If you forget this rule and inadvertently tie parameters together for which derivatives are indeed calculated by different means, PEST or PESTCHEK will detect the error and remind you of this.
When using JUPITER protocol for supplying model-calculated derivatives to PEST when running in “predictive analysis” mode, there is no need to place the sole member of the observation group predict last in the list of observations. As in normal PEST operation, this can be placed anywhere within the “observation data” section of the PEST control file.
Due to the fact that parameters and observations for which external derivatives are available are specifically identified in the derivatives interface file, a value of -1.11e33 signifying non-availability of a model-calculated derivative for a certain parameter with respect to a certain observation is not required. Hence this value is treated like any other.
External derivatives can be supplied for a parameter irrespective of whether that parameter is adjustable or fixed. Thus the decision to fix a parameter can be made without reference to the manner in which derivatives are obtained.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 12. Model-Calculated Derivatives (continuación)
- **Subsection:** 12.6 JUPITER Protocol for External Derivatives

### Additional Summaries
- **Higher-Level Summary:** PEST uses pest.mmf to send messages before each run, indicating run type and parameter details. Different commands can be used for regular and derivative-calculating model runs, potentially reducing run time. Models can provide PEST with derivatives more efficiently, supporting various file formats. PEST control file variables manage model commands, messaging, and external derivatives.
- **Detailed Summary:** PEST supports USGS JUPITER format external derivatives files, with specific formatting rules enforced by PEST and PESTCHEK. The JUPITER derivatives interface file contains DERFILE, NSKIP, NDEP/NPAR, ORIENTATION, DERFORMAT, parameter names, and dependent names. To use JUPITER external derivatives, set JACFILE to 2, specify DERCOM values, and prepare the interface file.

### Related Context
- **Previous Summary:** To use JUPITER external derivatives, set JACFILE to 2, specify DERCOM values, include a "derivatives command line" section (model command and derivatives interface filename), and prepare the derivatives interface file (described previously).  The EXTDERFLE variable now names the interface file.
- **Next Summary:** For SVD-assisted inversion (SVDA_EXTSUPER≠1), PEST uses model-provided base parameter derivatives. Set JACFILE=1 and DERCOM=0 for all super parameters in the control file.  The external derivatives file must be uncompressed ASCII; JUPITER format and -1.11e33 values are not supported. A base parameter JCO file is still needed for initial super parameter definition and derivative calculation.

### Metadata
- **Keywords:** DERCOM, NOBS, NPAR
- **Chunk ID:** 79af61e8b5fc
- **Chunk Index:** 1
- **Previous Chunk ID:** 7b384e1fb36b
- **Next Chunk ID:** 923b0e08fd67

---

## Context

### Summary
**SCREENDISP ("noverbose" or "verbose") controls TEMPCHEK and INSCHEK screen output. NPAR matches the number of parameters in template and parameter variation files. NOBS matches the number of observations in instruction files. NTPFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS ("single" or "double") sets numerical precision (single usually suffices).**

### Header
**17.2.6 Control Data Section**

### Content
SCREENDISP
SCREENDISP is a character variable which can take either one of two possible values. These values are “noverbose” and “verbose”. In the former case, when SENSAN runs TEMPCHEK and INSCHEK it redirects all of the screen output from these programs to the null file; hence the user is not aware that they are running. In the latter case, TEMPCHEK and INSCHEK output is directed to the screen in the usual fashion.
Once you have set up a SENSAN run and ensured that everything is working correctly, a nicer screen display is obtained by using the “noverbose” option. In this case you should ensure that the model likewise produces no screen output by redirecting its output to the null file using, for example, the command
model > nul
to run the model. For a UNIX system this command becomes
model > /dev/null
If SENSAN is thus left to produce the only screen output, you can monitor its progress and detect any SENSAN error messages if they are written to the screen.
NPAR
This is the number of parameters. It must agree with the number of parameters cited in the template file(s) used by SENSAN. It must also agree with the number of parameters named in the parameter variation file provided to SENSAN.
NOBS
NOBS is the number of “observations”, i.e. the number of model outcomes used in the sensitivity analysis process. It must agree with the number of observations cited in the instruction file(s) provided to SENSAN.
NTPFLE
NTPFLE is the number of template files to be used by SENSAN. For each template file there must be a corresponding model input file; see below. Note that a given template file can be used to write more than one model input file; however two templates cannot write the same model input file.
NINSFLE
NINSFLE is the number of instruction files used by SENSAN to read model outcomes. For each instruction file there must be a matching model output file. Note that the same instruction file cannot read more than one model output file (observation values would be overwritten); however two different instruction files can read the same model output file.
PRECIS
PRECIS is a character variable which must take either the value “single” or “double”. It determines whether single or double precision protocol is used to represent a very large or very small number, or a number in a wide parameter space; see section 2.2.6 for more details. The value “single” is usually appropriate.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 17. SENSAN (continuación)
- **Subsection:** 17.2 SENSAN File Requirements (continuación)

### Additional Summaries
- **Higher-Level Summary:** SENSAN uses control, parameter variation, and PEST template and instruction files. It runs system commands post-model runs, with options for OS commands or executables. PEST templates generate model inputs, instructions read outputs. Run with `sensan infile`, using tempchek.exe and inschek.exe. Outputs include ABSFLE, RELFLE, SENSFLE. SENSCHEK checks input data.
- **Detailed Summary:** SENSAN utilizes a control file, parameter variation file, and PEST template and instruction files. It executes system commands after model runs, with options for operating system commands or executables. PEST template files are used to generate model input files, and instruction files are employed to read model outputs.

### Related Context
- **Previous Summary:** The SENSAN control file (Figure 17.2, recommended ".sns" extension) starts with "scf", contains sections marked by "*", and uses many PEST variables. It includes control data, SENSAN files (parameter variation file, base output file, relative output file, sensitivity file), model command line, and model input/output (template and instruction files, Figure 17.3).
- **Next Summary:** VARFLE names the parameter variation file (must match NPAR).  ABSFLE, RELFLE, and SENSFLE name SENSAN's output files (contents described below).

### Metadata
- **Keywords:** NINSFLE, NOBS, NPAR, PRECIS
- **Chunk ID:** 6592c97ef380
- **Chunk Index:** 1
- **Previous Chunk ID:** e87ee1e03ea0
- **Next Chunk ID:** c13ba89f9f8d

---

## Context

### Summary
**NPAR (total parameters), NOBS (observations, excluding dummy), NPARGP (parameter groups), NPRIOR (prior information items), and NOBSGP (observation groups) are integer variables in the PEST control file.  In "estimation" mode, adjustable parameters should not exceed weighted observations plus prior information, unless using SVD or LSQR. MAXCOMPDIM (optional) activates compressed Jacobian matrix storage.**

### Header
**4.2.4 Third Line**

### Content
NPAR
This is the total number of parameters featured in the current PEST case, including adjustable, fixed and tied parameters; NPAR must be supplied as an integer.
NOBS
This integer variable represents the total number of observations featured in the current case. Note that, when counting the number of observations, dummy observations (see chapter 2) that may be featured in one or a number of instruction files are ignored.
NPARGP
This is the number of parameter groups. Recall from the previous chapter that the variables which govern the operation of finite-difference derivatives are assigned to parameter groups. Parameter grouping can also be of importance where the ADDREG1 utility described in part II of this manual is employed to add preferred value Tikhonov regularisation to a PEST control file. NPARGP is an integer variable.
NPRIOR
NPRIOR, another integer variable, is the number of articles of prior information that are included in the parameter estimation process. If there are no articles of prior information, NPRIOR must be zero. If PEST is running in “estimation” mode, then you should ensure that the number of adjustable parameters is less than or equal to the number of observations for which there are non-zero weights plus the number of articles of prior information for which there are non-zero weights. If this is not the case, then the inverse problem cannot possibly have a unique solution. Furthermore, unless solution of this nonunique inverse problem is sought using singular value decomposition or LSQR, PEST may make little progress in lowering the objective function because the XtQX matrix appearing in equation 5.2.9 of Doherty (2015) will be singular and hence non-invertible. Sadly, nonuniqueness is the rule rather than the exception when calibrating environmental models. PEST is not troubled by parameter nonuniqueness if Tikhonov regularisation is introduced to the inverse problem, and if singular value decomposition or LSQR is used in solution of that problem. Because of the prevalence of nonuniqueness in environmental model calibration, this should be done as a matter of course. (The outnumbering of observations by parameters does not create a numerical problem if singular value decomposition or LSQR are used to solve the inverse problem, despite the noninvertability of XtQX.)
NOBSGP
NOBSGP, another integer variable, is the number of observation groups featured in the PEST control file. Each observation and each prior information equation must be assigned to an observation group (they can all be assigned to the same group if desired). When PEST evaluates the total objective function it also evaluates the contribution made to this total by each observation group.
MAXCOMPDIM
MAXCOMPDIM is an optional integer variable. It is used to activate compressed internal storage of the Jacobian matrix by PEST. This can slow PEST execution. At the same time it can allow PEST to undertake very highly parameterized inversion wherein adjustable parameters may number in the tens of thousands. This is further discussed in section 15.4.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** RSTFLE ("restart" or "norestart") enables PEST's restart capability (Appendix B). PESTMODE ("estimation", "prediction", "regularisation", or "pareto") selects the operational mode;  additional mode-specific sections may be included.
- **Next Summary:** DERZEROLIM (optional) defines a Jacobian matrix zero threshold for compressed storage. NTPLFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS ("single" or "double") sets precision. DPOINT ("point" or "nopoint") controls decimal point inclusion. NUMCOM, JACFILE, MESSFILE (Chapter 12) handle model-calculated derivatives. OBSREREF (Chapter 14) activates observation re-referencing.

### Metadata
- **Keywords:** MAXCOMPDIM, NOBS, NOBSGP, NPAR, NPARGP, NPRIOR
- **Chunk ID:** 26873b456a9c
- **Chunk Index:** 1
- **Previous Chunk ID:** 9b2451e25955
- **Next Chunk ID:** e611a7673cad

---

## Context

### Summary
**PEST accepts ASCII (number of columns, rows;  Figure 12.2) or compressed ASCII (NPAR, NOBS, NDIMCOMP;  Figure 12.3) external derivatives files.  Compressed files list only non-zero elements.  Binary versions (with NDIMCOMP, 4-byte integers, 8-byte doubles) are also supported.  PEST deletes existing files before running the model; errors indicate model failure or file writing issues.**

### Header
**12.4.3 File Formats**

### Content
ASCII Uncompressed
The external derivatives file can be an ASCII (i.e. text) file in which numbers are separated by spaces, tabs or a comma (it is read by PEST using free field input). This file must be headed by a line containing two integers. These are the number of columns and rows comprising the following matrix. These numbers must be NPAR and NOBS respectively where NPAR is the number of parameters and NOBS is the number of observations cited in the PEST control file for the current case. The ordering of parameters and observations in the external derivatives file must be the same as that in the PEST control file. Note that a column must be included in the derivatives matrix for every parameter, even for those parameters which are tied or fixed (PEST ignores derivatives calculated with respect to fixed parameters). Similarly, there must be a row for every observation cited in the PEST control file, even for observations which are assigned a weight of zero.
Where there are many parameters to be estimated, each row representing the derivatives of a particular observation with respect to all parameters can be wrapped onto the next line (or as many lines as you wish). However derivatives for the next observation must begin on a new line.
Figure 12.2 shows an example of an uncompressed ASCII external derivatives file.
|4|9| | |
|---|---|---|---|
|5.00000|1707.60|34.4932|42.1234|
|5.25066|8.79458|93.2321|23.5921|
|1.04819|1.16448|5.34642|19.3235|
|1.52323|0.11418|0.59235|75.2354|
|3.21342|0.48392|9.49293|95.3459|
|2.49321|5.39230|0.49332|9.22934|
|19.4492|9.93024|0.49304|5.39234|
|36.3444|10.4933|0.59439|6.49345|
|95.4592|86.4234|47.4232|324.434|
Figure 12.2 An uncompressed ASCII external derivatives file.
ASCII Compressed
PEST provides an option for supplying the external derivatives file in a more compressed format than that illustrated in figure 12.2. This format is depicted in figure 12.3.
NPAR NOBS NDIMCOMP
IPAR1 IOBS1 DERIV(IOBS1,IPAR1)
IPAR2 IOBS2 DERIV(IOBS2,IPAR2)
..
ndimcomp times
Figure 12.3 Format for a compressed ASCII external derivatives file.
The first line of a compressed external derivatives file should contain three integers, namely NPAR and NOBS (same as for the uncompressed alternative), and another entry named NDIMCOMP. NDIMCOMP must be set to 0, or to a positive number equal to the number of entries to follow. If it is set to 0 (or omitted), the following Jacobian matrix is assumed to adopt the protocol depicted in figure 12.2. If it is set to a positive number, it informs PEST
that NDIMCOMP lines of data follow in this file. Each of the following lines must contain three entries. The first two entries (IPAR and IOBS) are integers whereas the third ((DERIV(IOBS,IPAR)) is a real number (which can be double precision if desired). IPAR is the parameter number, while IOBS is the observation number; DERIV(IOBS, IPAR) is the element of the derivatives matrix corresponding to observation IOBS and parameter IPAR. Only non-zero elements of the derivatives matrix need to be supplied; missing elements are assumed to be zero.
Compressed storage of an externally-supplied derivatives matrix can result in a dramatic reduction in the size of the external derivatives file where a large number of nonlinear (and hence model-calculated) regularisation constraints are used in the inversion process, for under these circumstances, the derivatives matrix normally has many zero-valued elements.
Binary Compressed and Uncompressed
Binary versions of the compressed and uncompressed external derivatives files described above can be read by PEST. However the following should be noted if supplying these types of file to PEST.
- Optional variables cannot be supplied in binary files. Hence, irrespective of whether a full or compressed matrix is provided, the NDIMCOMP variable must be supplied in the header to a binary external derivatives file. If NDIMCOMP is set to zero, PEST takes this as a signal that the full matrix follows. If it is set to a positive number, this indicates the number of ensuing data lines. If it is supplied as a negative number, PEST ceases execution with an error message.
- Integer values are expected as four byte numbers. However NCOMPDIM is expected to be of eight bytes length if an INTEL compiled version of PEST is employed. (This accommodates very large derivative matrices.)
- Matrix elements are expected as double precision (eight bytes) real numbers.
File Management
If you notify PEST that the model will supply an external derivatives file, then you must also inform PEST of the name of this file, the protocol that it adopts for storage of matrix elements, and of the command which PEST must use to run the model in such a way that it writes this file. (The mechanism for accomplishing all of these is discussed below.) Just before issuing this command (it is issued once for every iteration of the inversion process) PEST first checks to see whether a derivatives file already exists. If such a file does exist, PEST deletes it. Thus if the model fails to run, PEST does not read the old file, mistaking it for the new one; instead it writes an error message to the screen informing you that the derivatives file cannot be found. Alternatively, if PEST issues an error message to the effect that it encountered a premature end to the external derivatives file, this indicates that either the model did not run to completion, or that there is an error in the code added to the model to write this file.
Derivatives Type

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 12. Model-Calculated Derivatives (continuación)
- **Subsection:** 12.4 Externally-Supplied Derivatives

### Additional Summaries
- **Higher-Level Summary:** PEST uses pest.mmf to send messages before each run, indicating run type and parameter details. Different commands can be used for regular and derivative-calculating model runs, potentially reducing run time. Models can provide PEST with derivatives more efficiently, supporting various file formats. PEST control file variables manage model commands, messaging, and external derivatives.
- **Detailed Summary:** Models can provide PEST with derivatives more efficiently than PEST's finite difference method. PEST can utilize these model-calculated derivatives via specially formatted external files, supporting ASCII, compressed ASCII, and binary formats. Models must be modified to create these files, which differ from PEST's Jacobian matrix and do not consider parameter transformations.

### Related Context
- **Previous Summary:** A model can provide PEST with derivatives via a specially formatted external derivatives file containing a derivatives matrix (rows=observations, columns=parameters).  This matrix differs from PEST's Jacobian matrix; it does not account for parameter transformations.  The model must be modified to create this file.
- **Next Summary:** For log-transformed parameters, the model provides derivatives with respect to untransformed parameters; PEST handles the conversion internally.  Similarly, PEST accounts for SCALE and OFFSET values, so the model need not.

### Metadata
- **Keywords:** NOBS, NPAR
- **Chunk ID:** cd22c15afc22
- **Chunk Index:** 1
- **Previous Chunk ID:** 423bada632b0
- **Next Chunk ID:** fd8dcba7c21b

---

```

# System Prompt
```

You are a **PEST Documentation Expert**. Your task is to answer questions about PEST documentation using only the provided documentation (in `{context}`). Follow these rules strictly:

1. **Direct Answer First:**  
   - Provide a concise and direct answer in Markdown format. Use clear line breaks to separate sections.
   - Use the following structure:

     **1) Definition**  
     - Provide a concise definition.  
     - Cite source(s) using the format "File: [filename], Section: [header]".

     **2) Possible Values**  
     - Describe valid or recognized values (including defaults if specified).  
     - Cite source(s).

     **3) Implications**  
     - Explain usage considerations or consequences for each value.  
     - If the documentation does not provide this information, state: "Information not available in the provided content. "

     **4) Practical Usage Notes**  
     - Include usage notes or examples only if explicitly provided in the documentation.  
     - Otherwise, state: "No usage notes found in the provided content."

     **5) Keywords**  
     - List any associated keywords as found in the documentation.  
     - If none are provided, state: "No keywords found in the provided content"

     **6) Follow-up References**  
     - Point out additional references or relevant sections from the documentation, if applicable.

2. **Follow-up Questions:**  
   - After your main answer, list **exactly 5 follow-up questions** (numbered 1 to 5) that help the user explore the parameter further.
   - **Do not provide any answers, commentary, or additional text** with these follow-up questions; simply list the questions.
   - Each question should reference specific sections from the documentation if available.

3. **Important Instructions:**  
   - **Do not mention internal processes, "chunks," or retrieval steps.**  
   - **Do not include any self-commentary or extra explanations beyond the structure above.**  
   - Use only the documentation provided in `{context}`.

Answer strictly following the structure and rules above.

```

# Full User Message
```

Question: What is npar?

Please provide a clear and concise answer using only the information from the documentation below. Follow these rules strictly:

1. **Cite Sources:**  
   - Use the format "File: [filename], Section: [header]" whenever you reference specific details.

2. **Include Examples:**  
   - Provide relevant examples from the documentation if available.

3. **Note Limitations:**  
   - If the documentation is incomplete or ambiguous, explicitly state: "Information not available in the provided content. I don't know."

4. **Follow-up Questions:**  
   - After your main answer, list **exactly 5 follow-up questions** (numbered 1 to 5) for further exploration.
   - **Do not provide answers to these follow-up questions.**
   - Each question should reference specific sections from the documentation if applicable.

5. **Keywords Section:**  
   - Include a "Keywords" section if applicable, listing any associated keywords as found in the documentation.
   - If none are provided, state: "No keywords found in the provided content. I don't know."

6. **Avoid Internal Details:**  
   - Do not mention internal processes, such as "chunks" or retrieval steps.
   - Do not include any self-commentary or extra explanations beyond what is requested.

7. **Be Concise and Accurate:**  
   - Do not invent details or assumptions. If information is missing, state: "Information not available in the provided content. I don't know."

**Available Documentation with Metadata:**
# Search Results for: What is npar?

Keywords: npar

## Variations
1. Can you explain what npar is?
2. What does npar refer to?
3. Could you describe what npar is?
4. Please clarify what npar means.
5. What is the definition of npar?


## Context

### Summary
**DERCOMB1 combines partial derivatives files into a complete external derivatives file (derfile2) for PEST. It uses a PEST control file (pestfile), a complete external derivatives file (derfile1, NOBS x NPAR), and a PEST matrix file (matfile, section 2.4) containing additional derivatives.  Matrix file derivatives replace those in derfile1, creating derfile2.  It's typically run within a model batch file. Use `DERCOMB1 pestfile matfile derfile1 derfile2`.**

### Header
**14.6.1 General**

### Content
“DERCOMB” stands for “derivatives combination”. The “1” suffix was included in the name of this utility in anticipation of the fact that it may not be the last utility written to perform a similar role. DERCOMB1 was written for use in calibration contexts where a model provides its own derivatives. As explained in chapter 12 of part I of this manual, these are read from an external derivatives file written by the model. This file can be of a compressed or uncompressed type.
Where a model run by PEST is comprised of different executable programs, each of which can compute derivatives of its own outputs with respect to some or all of the parameters involved in the current PEST run, then the derivatives file written by each of them will be incomplete. The role of DERCOMB1 is to build a complete derivatives file by combining such partial derivatives files.
DERCOMB1 must be provided with the names of two derivatives files. The first of these must be a standard PEST external derivatives file which is “complete” in the sense that its dimensions are NOBS×NPAR where NPAR and NOBS are the numbers of parameters and observations respectively employed by PEST. Such a file may have been produced, for example, by the ASENPROC Groundwater Data Utility program. Elements of the derivatives matrix that ASENPROC cannot compute are supplied with a dummy value of ‑1.11E33, this being PEST’s expected value for derivative matrix elements which have not been determined.
The second derivatives file must be in PEST matrix file format (see section 2.4 of this manual for specifications of this file type). A derivatives file in matrix format is written, for example, by the ZONE2VAR1 Groundwater Data Utility program. Like the first file, this file must also contain derivatives of model outputs with respect to parameters as its elements. However, unlike the first file, it is not necessary that all parameters and observations cited in the PEST control file be cited in this file. Thus the matrix can have dimensions that are smaller than NOBS×NPAR. The names of the observations and parameters to which the derivatives in this file pertain are provided as matrix row and column names respectively. Each one of these must correspond to an observation or parameter featured in the PEST control file for the current problem.
DERCOMB1 reads the first derivatives file, and then the second derivatives file. It verifies that the first has dimensions of NOBS×NPAR. (It does not check parameter and observation names in this file, as this file does not need to provide these; it is simply assumed that parameters and observations are represented in the same order in this file as they are represented in the PEST control file which defines the current inverse problem.)
14.6.2 Using DERCOMB1
DERCOMB1 then reads the matrix file. Each derivative represented in the matrix file then replaces the corresponding derivative represented in the external derivatives file. DERCOMB1 then writes a new external derivatives file with these modified derivatives.
DERCOMB1 is run using the command:
DERCOMB1 pestfile matfile derfile1 derfile2
where
- pestfile is the name of a PEST control file,
- matfile is the name of matrix file,
- derfile1 is the name of an existing external derivatives file, and
- derfile2 is the name of a new external derivatives file.
As stated above, the existing PEST external derivatives file must contain a derivatives matrix (represented in either full or compressed form) with dimensions of NOBS×NPAR, where NOBS is the number of observations cited in the PEST control file and NPAR is the number of parameters cited in this file. The matrix file must contain a matrix whose dimensions are equal to or less than these; however, all observations and parameters cited as row and column names in the matrix file must also be cited in the PEST control file (though not necessarily in the same order). DERCOMB1 replaces derivatives read from the existing external derivatives file with those read from the matrix file. It then writes a new external derivatives file with the upgraded derivatives. If the original derivatives file is supplied in compressed format, then the new derivatives file written by DERCOMB1 will also employ compressed format. (Note that DERCOMB1 does not read or write binary derivatives files.)
DERCOMB1 will normally be run as part of a model batch or script file cited in the “derivatives command line” section of a PEST control file. It will run after the model component that writes the external derivatives file as well as the model component that writes the matrix file of derivatives. Where there are many model executables and each of them calculate some of the derivatives required by PEST, DERCOMB1 may be run multiple times as part of the one model.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software
- **Main Section:** 14. Miscellaneous Utilities
- **Subsection:** 14.6 DERCOMB

### Additional Summaries
- **Higher-Level Summary:** Observation re-referencing simplifies derivative calculations by adjusting initial model conditions based on upgraded parameters, improving solver convergence time. It involves creating reference model outputs for accurate derivatives, with specific commands and activation steps. SVDAPREP and BEOPEST support this feature, enhancing model accuracy and efficiency.
- **Detailed Summary:** BEOPEST (but not Parallel PEST) supports observation re-referencing.  Adding "obsreref_N" to the "control data" section causes BEOPEST to complete re-referencing runs before starting Jacobian runs, pausing for N seconds afterwards. This ensures initial conditions are available for Jacobian runs, especially when copying initial condition files to agent directories.

### Related Context
- **Previous Summary:** PESTLIN linearizes a PEST dataset (pestincase.pst, .jco, .rec), creating a GENLIN dataset (linbasename.in, .out, .ins, .tpl) and a new PEST control file (pestoutcase.pst).  The `/d` switch enables external derivatives.  It handles tied parameters. Use `pestlin pestincase pestoutcase linbasename [/d]`.
- **Next Summary:** This chapter details PEST matrix file (section 2.4) manipulation utilities.  These utilities process matrices including Jacobian matrices, normal matrices, covariance matrices, and sensitivity vectors.  Chapter 5 describes JCO-to-matrix file conversion utilities (JCO2MAT, MAT2JCO, JROW2VEC, JROW2MAT).  Utilities are documented alphabetically.

### Metadata
- **Keywords:** NOBS, NPAR
- **Chunk ID:** e7a2cd220c27
- **Chunk Index:** 1
- **Previous Chunk ID:** fe9c86ccbde4
- **Next Chunk ID:** dcb2e352068d

---

## Context

### Summary
**If all derivatives are external (NDEP=NOBS), all DERCOM values should be 0. Otherwise, non-zero DERCOM values are needed for parameters requiring finite-difference derivatives.  Tied parameters require external derivatives for both the tied and parent parameters if either is in the derivatives interface file.  The "predict" group's observation placement is flexible in "predictive analysis" mode.  -1.11e33 is not needed; external derivatives can be supplied for fixed or adjustable parameters.**

### Header
**12.6.4 Special Considerations**

### Content
If DERCOM for a particular parameter is set to zero in the “parameter data” section of the PEST control file, this informs PEST that no finite-difference derivatives calculation with respect to that parameter is required; that is, the derivatives of all observations with respect to that parameter are supplied by the model. If this is the case, the NDEP variable in the derivatives interface file must be equal to NOBS – the total number of observations. On the other hand, if NDEP is not set to NOBS in a particular derivatives interface file, this indicates that there are some observations for all parameters for which derivatives must be calculated by finite differences, and hence DERCOM must be set to a non-zero value (normally 1) for each parameter.
If NDEP is equal to NOBS, and NPAR in the derivatives interface file is not equal to NPAR in the PEST control file (i.e. the total number of parameters), then parameters are effectively subdivided into two groups – those for which derivatives for all observations are supplied by the model, and those for which derivatives for all observations must be calculated by finite differences. DERCOM for all of the former parameters must be set to zero; for all of the latter parameters it must be set to an appropriate non-zero value. If NDEP is equal to NOBS, and NPAR in the derivatives interface file is equal to NPAR in the PEST control file (i.e. the total number of cited parameters), then all parameters should have a DERCOM value of zero.
Special considerations apply to tied parameters. The tied parameter is not adjusted, but instead maintains the same ratio with the parent parameter as that supplied through initial parameter values; derivatives of parent parameters are adjusted to accommodate the existence of one or more tied parameters.
If a decision is made to tie a parameter to a parent parameter in the PEST control file, no alterations are required to the derivatives interface file. However certain ties are forbidden. In particular, a parameter cited in a derivatives interface file can only be tied to a parameter that is also cited in the derivatives interface file. This rule ensures that there will be no observations for which derivatives with respect to a tied parameter are calculated by the model while derivatives with respect to the parent parameter are calculated by finite differences. The reverse of this rule also applies. That is, a parameter that is not cited in the derivatives interface file cannot be tied to a parameter that is cited within this file. This will rarely be a harsh restriction, for normally it is only parameters that are similar to each other that are tied to each other; derivatives with respect to similar parameters are normally calculated by similar means. If you forget this rule and inadvertently tie parameters together for which derivatives are indeed calculated by different means, PEST or PESTCHEK will detect the error and remind you of this.
When using JUPITER protocol for supplying model-calculated derivatives to PEST when running in “predictive analysis” mode, there is no need to place the sole member of the observation group predict last in the list of observations. As in normal PEST operation, this can be placed anywhere within the “observation data” section of the PEST control file.
Due to the fact that parameters and observations for which external derivatives are available are specifically identified in the derivatives interface file, a value of -1.11e33 signifying non-availability of a model-calculated derivative for a certain parameter with respect to a certain observation is not required. Hence this value is treated like any other.
External derivatives can be supplied for a parameter irrespective of whether that parameter is adjustable or fixed. Thus the decision to fix a parameter can be made without reference to the manner in which derivatives are obtained.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 12. Model-Calculated Derivatives (continuación)
- **Subsection:** 12.6 JUPITER Protocol for External Derivatives

### Additional Summaries
- **Higher-Level Summary:** PEST uses pest.mmf to send messages before each run, indicating run type and parameter details. Different commands can be used for regular and derivative-calculating model runs, potentially reducing run time. Models can provide PEST with derivatives more efficiently, supporting various file formats. PEST control file variables manage model commands, messaging, and external derivatives.
- **Detailed Summary:** PEST supports USGS JUPITER format external derivatives files, with specific formatting rules enforced by PEST and PESTCHEK. The JUPITER derivatives interface file contains DERFILE, NSKIP, NDEP/NPAR, ORIENTATION, DERFORMAT, parameter names, and dependent names. To use JUPITER external derivatives, set JACFILE to 2, specify DERCOM values, and prepare the interface file.

### Related Context
- **Previous Summary:** To use JUPITER external derivatives, set JACFILE to 2, specify DERCOM values, include a "derivatives command line" section (model command and derivatives interface filename), and prepare the derivatives interface file (described previously).  The EXTDERFLE variable now names the interface file.
- **Next Summary:** For SVD-assisted inversion (SVDA_EXTSUPER≠1), PEST uses model-provided base parameter derivatives. Set JACFILE=1 and DERCOM=0 for all super parameters in the control file.  The external derivatives file must be uncompressed ASCII; JUPITER format and -1.11e33 values are not supported. A base parameter JCO file is still needed for initial super parameter definition and derivative calculation.

### Metadata
- **Keywords:** DERCOM, NOBS, NPAR
- **Chunk ID:** 79af61e8b5fc
- **Chunk Index:** 1
- **Previous Chunk ID:** 7b384e1fb36b
- **Next Chunk ID:** 923b0e08fd67

---

## Context

### Summary
**SCREENDISP ("noverbose" or "verbose") controls TEMPCHEK and INSCHEK screen output. NPAR matches the number of parameters in template and parameter variation files. NOBS matches the number of observations in instruction files. NTPFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS ("single" or "double") sets numerical precision (single usually suffices).**

### Header
**17.2.6 Control Data Section**

### Content
SCREENDISP
SCREENDISP is a character variable which can take either one of two possible values. These values are “noverbose” and “verbose”. In the former case, when SENSAN runs TEMPCHEK and INSCHEK it redirects all of the screen output from these programs to the null file; hence the user is not aware that they are running. In the latter case, TEMPCHEK and INSCHEK output is directed to the screen in the usual fashion.
Once you have set up a SENSAN run and ensured that everything is working correctly, a nicer screen display is obtained by using the “noverbose” option. In this case you should ensure that the model likewise produces no screen output by redirecting its output to the null file using, for example, the command
model > nul
to run the model. For a UNIX system this command becomes
model > /dev/null
If SENSAN is thus left to produce the only screen output, you can monitor its progress and detect any SENSAN error messages if they are written to the screen.
NPAR
This is the number of parameters. It must agree with the number of parameters cited in the template file(s) used by SENSAN. It must also agree with the number of parameters named in the parameter variation file provided to SENSAN.
NOBS
NOBS is the number of “observations”, i.e. the number of model outcomes used in the sensitivity analysis process. It must agree with the number of observations cited in the instruction file(s) provided to SENSAN.
NTPFLE
NTPFLE is the number of template files to be used by SENSAN. For each template file there must be a corresponding model input file; see below. Note that a given template file can be used to write more than one model input file; however two templates cannot write the same model input file.
NINSFLE
NINSFLE is the number of instruction files used by SENSAN to read model outcomes. For each instruction file there must be a matching model output file. Note that the same instruction file cannot read more than one model output file (observation values would be overwritten); however two different instruction files can read the same model output file.
PRECIS
PRECIS is a character variable which must take either the value “single” or “double”. It determines whether single or double precision protocol is used to represent a very large or very small number, or a number in a wide parameter space; see section 2.2.6 for more details. The value “single” is usually appropriate.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 17. SENSAN (continuación)
- **Subsection:** 17.2 SENSAN File Requirements (continuación)

### Additional Summaries
- **Higher-Level Summary:** SENSAN uses control, parameter variation, and PEST template and instruction files. It runs system commands post-model runs, with options for OS commands or executables. PEST templates generate model inputs, instructions read outputs. Run with `sensan infile`, using tempchek.exe and inschek.exe. Outputs include ABSFLE, RELFLE, SENSFLE. SENSCHEK checks input data.
- **Detailed Summary:** SENSAN utilizes a control file, parameter variation file, and PEST template and instruction files. It executes system commands after model runs, with options for operating system commands or executables. PEST template files are used to generate model input files, and instruction files are employed to read model outputs.

### Related Context
- **Previous Summary:** The SENSAN control file (Figure 17.2, recommended ".sns" extension) starts with "scf", contains sections marked by "*", and uses many PEST variables. It includes control data, SENSAN files (parameter variation file, base output file, relative output file, sensitivity file), model command line, and model input/output (template and instruction files, Figure 17.3).
- **Next Summary:** VARFLE names the parameter variation file (must match NPAR).  ABSFLE, RELFLE, and SENSFLE name SENSAN's output files (contents described below).

### Metadata
- **Keywords:** NINSFLE, NOBS, NPAR, PRECIS
- **Chunk ID:** 6592c97ef380
- **Chunk Index:** 1
- **Previous Chunk ID:** e87ee1e03ea0
- **Next Chunk ID:** c13ba89f9f8d

---

## Context

### Summary
**NPAR (total parameters), NOBS (observations, excluding dummy), NPARGP (parameter groups), NPRIOR (prior information items), and NOBSGP (observation groups) are integer variables in the PEST control file.  In "estimation" mode, adjustable parameters should not exceed weighted observations plus prior information, unless using SVD or LSQR. MAXCOMPDIM (optional) activates compressed Jacobian matrix storage.**

### Header
**4.2.4 Third Line**

### Content
NPAR
This is the total number of parameters featured in the current PEST case, including adjustable, fixed and tied parameters; NPAR must be supplied as an integer.
NOBS
This integer variable represents the total number of observations featured in the current case. Note that, when counting the number of observations, dummy observations (see chapter 2) that may be featured in one or a number of instruction files are ignored.
NPARGP
This is the number of parameter groups. Recall from the previous chapter that the variables which govern the operation of finite-difference derivatives are assigned to parameter groups. Parameter grouping can also be of importance where the ADDREG1 utility described in part II of this manual is employed to add preferred value Tikhonov regularisation to a PEST control file. NPARGP is an integer variable.
NPRIOR
NPRIOR, another integer variable, is the number of articles of prior information that are included in the parameter estimation process. If there are no articles of prior information, NPRIOR must be zero. If PEST is running in “estimation” mode, then you should ensure that the number of adjustable parameters is less than or equal to the number of observations for which there are non-zero weights plus the number of articles of prior information for which there are non-zero weights. If this is not the case, then the inverse problem cannot possibly have a unique solution. Furthermore, unless solution of this nonunique inverse problem is sought using singular value decomposition or LSQR, PEST may make little progress in lowering the objective function because the XtQX matrix appearing in equation 5.2.9 of Doherty (2015) will be singular and hence non-invertible. Sadly, nonuniqueness is the rule rather than the exception when calibrating environmental models. PEST is not troubled by parameter nonuniqueness if Tikhonov regularisation is introduced to the inverse problem, and if singular value decomposition or LSQR is used in solution of that problem. Because of the prevalence of nonuniqueness in environmental model calibration, this should be done as a matter of course. (The outnumbering of observations by parameters does not create a numerical problem if singular value decomposition or LSQR are used to solve the inverse problem, despite the noninvertability of XtQX.)
NOBSGP
NOBSGP, another integer variable, is the number of observation groups featured in the PEST control file. Each observation and each prior information equation must be assigned to an observation group (they can all be assigned to the same group if desired). When PEST evaluates the total objective function it also evaluates the contribution made to this total by each observation group.
MAXCOMPDIM
MAXCOMPDIM is an optional integer variable. It is used to activate compressed internal storage of the Jacobian matrix by PEST. This can slow PEST execution. At the same time it can allow PEST to undertake very highly parameterized inversion wherein adjustable parameters may number in the tens of thousands. This is further discussed in section 15.4.

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 4. The PEST Control File
- **Subsection:** 4.2 Control Data Section

### Additional Summaries
- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.
- **Detailed Summary:** Figure 4.2 shows "control data" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be "* control data";  some variables are optional (in brackets).

### Related Context
- **Previous Summary:** RSTFLE ("restart" or "norestart") enables PEST's restart capability (Appendix B). PESTMODE ("estimation", "prediction", "regularisation", or "pareto") selects the operational mode;  additional mode-specific sections may be included.
- **Next Summary:** DERZEROLIM (optional) defines a Jacobian matrix zero threshold for compressed storage. NTPLFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS ("single" or "double") sets precision. DPOINT ("point" or "nopoint") controls decimal point inclusion. NUMCOM, JACFILE, MESSFILE (Chapter 12) handle model-calculated derivatives. OBSREREF (Chapter 14) activates observation re-referencing.

### Metadata
- **Keywords:** MAXCOMPDIM, NOBS, NOBSGP, NPAR, NPARGP, NPRIOR
- **Chunk ID:** 26873b456a9c
- **Chunk Index:** 1
- **Previous Chunk ID:** 9b2451e25955
- **Next Chunk ID:** e611a7673cad

---

## Context

### Summary
**PEST accepts ASCII (number of columns, rows;  Figure 12.2) or compressed ASCII (NPAR, NOBS, NDIMCOMP;  Figure 12.3) external derivatives files.  Compressed files list only non-zero elements.  Binary versions (with NDIMCOMP, 4-byte integers, 8-byte doubles) are also supported.  PEST deletes existing files before running the model; errors indicate model failure or file writing issues.**

### Header
**12.4.3 File Formats**

### Content
ASCII Uncompressed
The external derivatives file can be an ASCII (i.e. text) file in which numbers are separated by spaces, tabs or a comma (it is read by PEST using free field input). This file must be headed by a line containing two integers. These are the number of columns and rows comprising the following matrix. These numbers must be NPAR and NOBS respectively where NPAR is the number of parameters and NOBS is the number of observations cited in the PEST control file for the current case. The ordering of parameters and observations in the external derivatives file must be the same as that in the PEST control file. Note that a column must be included in the derivatives matrix for every parameter, even for those parameters which are tied or fixed (PEST ignores derivatives calculated with respect to fixed parameters). Similarly, there must be a row for every observation cited in the PEST control file, even for observations which are assigned a weight of zero.
Where there are many parameters to be estimated, each row representing the derivatives of a particular observation with respect to all parameters can be wrapped onto the next line (or as many lines as you wish). However derivatives for the next observation must begin on a new line.
Figure 12.2 shows an example of an uncompressed ASCII external derivatives file.
|4|9| | |
|---|---|---|---|
|5.00000|1707.60|34.4932|42.1234|
|5.25066|8.79458|93.2321|23.5921|
|1.04819|1.16448|5.34642|19.3235|
|1.52323|0.11418|0.59235|75.2354|
|3.21342|0.48392|9.49293|95.3459|
|2.49321|5.39230|0.49332|9.22934|
|19.4492|9.93024|0.49304|5.39234|
|36.3444|10.4933|0.59439|6.49345|
|95.4592|86.4234|47.4232|324.434|
Figure 12.2 An uncompressed ASCII external derivatives file.
ASCII Compressed
PEST provides an option for supplying the external derivatives file in a more compressed format than that illustrated in figure 12.2. This format is depicted in figure 12.3.
NPAR NOBS NDIMCOMP
IPAR1 IOBS1 DERIV(IOBS1,IPAR1)
IPAR2 IOBS2 DERIV(IOBS2,IPAR2)
..
ndimcomp times
Figure 12.3 Format for a compressed ASCII external derivatives file.
The first line of a compressed external derivatives file should contain three integers, namely NPAR and NOBS (same as for the uncompressed alternative), and another entry named NDIMCOMP. NDIMCOMP must be set to 0, or to a positive number equal to the number of entries to follow. If it is set to 0 (or omitted), the following Jacobian matrix is assumed to adopt the protocol depicted in figure 12.2. If it is set to a positive number, it informs PEST
that NDIMCOMP lines of data follow in this file. Each of the following lines must contain three entries. The first two entries (IPAR and IOBS) are integers whereas the third ((DERIV(IOBS,IPAR)) is a real number (which can be double precision if desired). IPAR is the parameter number, while IOBS is the observation number; DERIV(IOBS, IPAR) is the element of the derivatives matrix corresponding to observation IOBS and parameter IPAR. Only non-zero elements of the derivatives matrix need to be supplied; missing elements are assumed to be zero.
Compressed storage of an externally-supplied derivatives matrix can result in a dramatic reduction in the size of the external derivatives file where a large number of nonlinear (and hence model-calculated) regularisation constraints are used in the inversion process, for under these circumstances, the derivatives matrix normally has many zero-valued elements.
Binary Compressed and Uncompressed
Binary versions of the compressed and uncompressed external derivatives files described above can be read by PEST. However the following should be noted if supplying these types of file to PEST.
- Optional variables cannot be supplied in binary files. Hence, irrespective of whether a full or compressed matrix is provided, the NDIMCOMP variable must be supplied in the header to a binary external derivatives file. If NDIMCOMP is set to zero, PEST takes this as a signal that the full matrix follows. If it is set to a positive number, this indicates the number of ensuing data lines. If it is supplied as a negative number, PEST ceases execution with an error message.
- Integer values are expected as four byte numbers. However NCOMPDIM is expected to be of eight bytes length if an INTEL compiled version of PEST is employed. (This accommodates very large derivative matrices.)
- Matrix elements are expected as double precision (eight bytes) real numbers.
File Management
If you notify PEST that the model will supply an external derivatives file, then you must also inform PEST of the name of this file, the protocol that it adopts for storage of matrix elements, and of the command which PEST must use to run the model in such a way that it writes this file. (The mechanism for accomplishing all of these is discussed below.) Just before issuing this command (it is issued once for every iteration of the inversion process) PEST first checks to see whether a derivatives file already exists. If such a file does exist, PEST deletes it. Thus if the model fails to run, PEST does not read the old file, mistaking it for the new one; instead it writes an error message to the screen informing you that the derivatives file cannot be found. Alternatively, if PEST issues an error message to the effect that it encountered a premature end to the external derivatives file, this indicates that either the model did not run to completion, or that there is an error in the code added to the model to write this file.
Derivatives Type

### Source
- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers
- **Main Section:** 12. Model-Calculated Derivatives (continuación)
- **Subsection:** 12.4 Externally-Supplied Derivatives

### Additional Summaries
- **Higher-Level Summary:** PEST uses pest.mmf to send messages before each run, indicating run type and parameter details. Different commands can be used for regular and derivative-calculating model runs, potentially reducing run time. Models can provide PEST with derivatives more efficiently, supporting various file formats. PEST control file variables manage model commands, messaging, and external derivatives.
- **Detailed Summary:** Models can provide PEST with derivatives more efficiently than PEST's finite difference method. PEST can utilize these model-calculated derivatives via specially formatted external files, supporting ASCII, compressed ASCII, and binary formats. Models must be modified to create these files, which differ from PEST's Jacobian matrix and do not consider parameter transformations.

### Related Context
- **Previous Summary:** A model can provide PEST with derivatives via a specially formatted external derivatives file containing a derivatives matrix (rows=observations, columns=parameters).  This matrix differs from PEST's Jacobian matrix; it does not account for parameter transformations.  The model must be modified to create this file.
- **Next Summary:** For log-transformed parameters, the model provides derivatives with respect to untransformed parameters; PEST handles the conversion internally.  Similarly, PEST accounts for SCALE and OFFSET values, so the model need not.

### Metadata
- **Keywords:** NOBS, NPAR
- **Chunk ID:** cd22c15afc22
- **Chunk Index:** 1
- **Previous Chunk ID:** 423bada632b0
- **Next Chunk ID:** fd8dcba7c21b

---


Answer strictly following the above instructions.

```

# Complete Messages Array
```json
[
  {
    "role": "system",
    "content": "\nYou are a **PEST Documentation Expert**. Your task is to answer questions about PEST documentation using only the provided documentation (in `{context}`). Follow these rules strictly:\n\n1. **Direct Answer First:**  \n   - Provide a concise and direct answer in Markdown format. Use clear line breaks to separate sections.\n   - Use the following structure:\n\n     **1) Definition**  \n     - Provide a concise definition.  \n     - Cite source(s) using the format \"File: [filename], Section: [header]\".\n\n     **2) Possible Values**  \n     - Describe valid or recognized values (including defaults if specified).  \n     - Cite source(s).\n\n     **3) Implications**  \n     - Explain usage considerations or consequences for each value.  \n     - If the documentation does not provide this information, state: \"Information not available in the provided content. \"\n\n     **4) Practical Usage Notes**  \n     - Include usage notes or examples only if explicitly provided in the documentation.  \n     - Otherwise, state: \"No usage notes found in the provided content.\"\n\n     **5) Keywords**  \n     - List any associated keywords as found in the documentation.  \n     - If none are provided, state: \"No keywords found in the provided content\"\n\n     **6) Follow-up References**  \n     - Point out additional references or relevant sections from the documentation, if applicable.\n\n2. **Follow-up Questions:**  \n   - After your main answer, list **exactly 5 follow-up questions** (numbered 1 to 5) that help the user explore the parameter further.\n   - **Do not provide any answers, commentary, or additional text** with these follow-up questions; simply list the questions.\n   - Each question should reference specific sections from the documentation if available.\n\n3. **Important Instructions:**  \n   - **Do not mention internal processes, \"chunks,\" or retrieval steps.**  \n   - **Do not include any self-commentary or extra explanations beyond the structure above.**  \n   - Use only the documentation provided in `{context}`.\n\nAnswer strictly following the structure and rules above.\n"
  },
  {
    "role": "user",
    "content": "\nQuestion: What is npar?\n\nPlease provide a clear and concise answer using only the information from the documentation below. Follow these rules strictly:\n\n1. **Cite Sources:**  \n   - Use the format \"File: [filename], Section: [header]\" whenever you reference specific details.\n\n2. **Include Examples:**  \n   - Provide relevant examples from the documentation if available.\n\n3. **Note Limitations:**  \n   - If the documentation is incomplete or ambiguous, explicitly state: \"Information not available in the provided content. I don't know.\"\n\n4. **Follow-up Questions:**  \n   - After your main answer, list **exactly 5 follow-up questions** (numbered 1 to 5) for further exploration.\n   - **Do not provide answers to these follow-up questions.**\n   - Each question should reference specific sections from the documentation if applicable.\n\n5. **Keywords Section:**  \n   - Include a \"Keywords\" section if applicable, listing any associated keywords as found in the documentation.\n   - If none are provided, state: \"No keywords found in the provided content. I don't know.\"\n\n6. **Avoid Internal Details:**  \n   - Do not mention internal processes, such as \"chunks\" or retrieval steps.\n   - Do not include any self-commentary or extra explanations beyond what is requested.\n\n7. **Be Concise and Accurate:**  \n   - Do not invent details or assumptions. If information is missing, state: \"Information not available in the provided content. I don't know.\"\n\n**Available Documentation with Metadata:**\n# Search Results for: What is npar?\n\nKeywords: npar\n\n## Variations\n1. Can you explain what npar is?\n2. What does npar refer to?\n3. Could you describe what npar is?\n4. Please clarify what npar means.\n5. What is the definition of npar?\n\n\n## Context\n\n### Summary\n**DERCOMB1 combines partial derivatives files into a complete external derivatives file (derfile2) for PEST. It uses a PEST control file (pestfile), a complete external derivatives file (derfile1, NOBS x NPAR), and a PEST matrix file (matfile, section 2.4) containing additional derivatives.  Matrix file derivatives replace those in derfile1, creating derfile2.  It's typically run within a model batch file. Use `DERCOMB1 pestfile matfile derfile1 derfile2`.**\n\n### Header\n**14.6.1 General**\n\n### Content\n“DERCOMB” stands for “derivatives combination”. The “1” suffix was included in the name of this utility in anticipation of the fact that it may not be the last utility written to perform a similar role. DERCOMB1 was written for use in calibration contexts where a model provides its own derivatives. As explained in chapter 12 of part I of this manual, these are read from an external derivatives file written by the model. This file can be of a compressed or uncompressed type.\nWhere a model run by PEST is comprised of different executable programs, each of which can compute derivatives of its own outputs with respect to some or all of the parameters involved in the current PEST run, then the derivatives file written by each of them will be incomplete. The role of DERCOMB1 is to build a complete derivatives file by combining such partial derivatives files.\nDERCOMB1 must be provided with the names of two derivatives files. The first of these must be a standard PEST external derivatives file which is “complete” in the sense that its dimensions are NOBS×NPAR where NPAR and NOBS are the numbers of parameters and observations respectively employed by PEST. Such a file may have been produced, for example, by the ASENPROC Groundwater Data Utility program. Elements of the derivatives matrix that ASENPROC cannot compute are supplied with a dummy value of ‑1.11E33, this being PEST’s expected value for derivative matrix elements which have not been determined.\nThe second derivatives file must be in PEST matrix file format (see section 2.4 of this manual for specifications of this file type). A derivatives file in matrix format is written, for example, by the ZONE2VAR1 Groundwater Data Utility program. Like the first file, this file must also contain derivatives of model outputs with respect to parameters as its elements. However, unlike the first file, it is not necessary that all parameters and observations cited in the PEST control file be cited in this file. Thus the matrix can have dimensions that are smaller than NOBS×NPAR. The names of the observations and parameters to which the derivatives in this file pertain are provided as matrix row and column names respectively. Each one of these must correspond to an observation or parameter featured in the PEST control file for the current problem.\nDERCOMB1 reads the first derivatives file, and then the second derivatives file. It verifies that the first has dimensions of NOBS×NPAR. (It does not check parameter and observation names in this file, as this file does not need to provide these; it is simply assumed that parameters and observations are represented in the same order in this file as they are represented in the PEST control file which defines the current inverse problem.)\n14.6.2 Using DERCOMB1\nDERCOMB1 then reads the matrix file. Each derivative represented in the matrix file then replaces the corresponding derivative represented in the external derivatives file. DERCOMB1 then writes a new external derivatives file with these modified derivatives.\nDERCOMB1 is run using the command:\nDERCOMB1 pestfile matfile derfile1 derfile2\nwhere\n- pestfile is the name of a PEST control file,\n- matfile is the name of matrix file,\n- derfile1 is the name of an existing external derivatives file, and\n- derfile2 is the name of a new external derivatives file.\nAs stated above, the existing PEST external derivatives file must contain a derivatives matrix (represented in either full or compressed form) with dimensions of NOBS×NPAR, where NOBS is the number of observations cited in the PEST control file and NPAR is the number of parameters cited in this file. The matrix file must contain a matrix whose dimensions are equal to or less than these; however, all observations and parameters cited as row and column names in the matrix file must also be cited in the PEST control file (though not necessarily in the same order). DERCOMB1 replaces derivatives read from the existing external derivatives file with those read from the matrix file. It then writes a new external derivatives file with the upgraded derivatives. If the original derivatives file is supplied in compressed format, then the new derivatives file written by DERCOMB1 will also employ compressed format. (Note that DERCOMB1 does not read or write binary derivatives files.)\nDERCOMB1 will normally be run as part of a model batch or script file cited in the “derivatives command line” section of a PEST control file. It will run after the model component that writes the external derivatives file as well as the model component that writes the matrix file of derivatives. Where there are many model executables and each of them calculate some of the derivatives required by PEST, DERCOMB1 may be run multiple times as part of the one model.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation User Manual Part II: PEST Utility Support Software\n- **Main Section:** 14. Miscellaneous Utilities\n- **Subsection:** 14.6 DERCOMB\n\n### Additional Summaries\n- **Higher-Level Summary:** Observation re-referencing simplifies derivative calculations by adjusting initial model conditions based on upgraded parameters, improving solver convergence time. It involves creating reference model outputs for accurate derivatives, with specific commands and activation steps. SVDAPREP and BEOPEST support this feature, enhancing model accuracy and efficiency.\n- **Detailed Summary:** BEOPEST (but not Parallel PEST) supports observation re-referencing.  Adding \"obsreref_N\" to the \"control data\" section causes BEOPEST to complete re-referencing runs before starting Jacobian runs, pausing for N seconds afterwards. This ensures initial conditions are available for Jacobian runs, especially when copying initial condition files to agent directories.\n\n### Related Context\n- **Previous Summary:** PESTLIN linearizes a PEST dataset (pestincase.pst, .jco, .rec), creating a GENLIN dataset (linbasename.in, .out, .ins, .tpl) and a new PEST control file (pestoutcase.pst).  The `/d` switch enables external derivatives.  It handles tied parameters. Use `pestlin pestincase pestoutcase linbasename [/d]`.\n- **Next Summary:** This chapter details PEST matrix file (section 2.4) manipulation utilities.  These utilities process matrices including Jacobian matrices, normal matrices, covariance matrices, and sensitivity vectors.  Chapter 5 describes JCO-to-matrix file conversion utilities (JCO2MAT, MAT2JCO, JROW2VEC, JROW2MAT).  Utilities are documented alphabetically.\n\n### Metadata\n- **Keywords:** NOBS, NPAR\n- **Chunk ID:** e7a2cd220c27\n- **Chunk Index:** 1\n- **Previous Chunk ID:** fe9c86ccbde4\n- **Next Chunk ID:** dcb2e352068d\n\n---\n\n## Context\n\n### Summary\n**If all derivatives are external (NDEP=NOBS), all DERCOM values should be 0. Otherwise, non-zero DERCOM values are needed for parameters requiring finite-difference derivatives.  Tied parameters require external derivatives for both the tied and parent parameters if either is in the derivatives interface file.  The \"predict\" group's observation placement is flexible in \"predictive analysis\" mode.  -1.11e33 is not needed; external derivatives can be supplied for fixed or adjustable parameters.**\n\n### Header\n**12.6.4 Special Considerations**\n\n### Content\nIf DERCOM for a particular parameter is set to zero in the “parameter data” section of the PEST control file, this informs PEST that no finite-difference derivatives calculation with respect to that parameter is required; that is, the derivatives of all observations with respect to that parameter are supplied by the model. If this is the case, the NDEP variable in the derivatives interface file must be equal to NOBS – the total number of observations. On the other hand, if NDEP is not set to NOBS in a particular derivatives interface file, this indicates that there are some observations for all parameters for which derivatives must be calculated by finite differences, and hence DERCOM must be set to a non-zero value (normally 1) for each parameter.\nIf NDEP is equal to NOBS, and NPAR in the derivatives interface file is not equal to NPAR in the PEST control file (i.e. the total number of parameters), then parameters are effectively subdivided into two groups – those for which derivatives for all observations are supplied by the model, and those for which derivatives for all observations must be calculated by finite differences. DERCOM for all of the former parameters must be set to zero; for all of the latter parameters it must be set to an appropriate non-zero value. If NDEP is equal to NOBS, and NPAR in the derivatives interface file is equal to NPAR in the PEST control file (i.e. the total number of cited parameters), then all parameters should have a DERCOM value of zero.\nSpecial considerations apply to tied parameters. The tied parameter is not adjusted, but instead maintains the same ratio with the parent parameter as that supplied through initial parameter values; derivatives of parent parameters are adjusted to accommodate the existence of one or more tied parameters.\nIf a decision is made to tie a parameter to a parent parameter in the PEST control file, no alterations are required to the derivatives interface file. However certain ties are forbidden. In particular, a parameter cited in a derivatives interface file can only be tied to a parameter that is also cited in the derivatives interface file. This rule ensures that there will be no observations for which derivatives with respect to a tied parameter are calculated by the model while derivatives with respect to the parent parameter are calculated by finite differences. The reverse of this rule also applies. That is, a parameter that is not cited in the derivatives interface file cannot be tied to a parameter that is cited within this file. This will rarely be a harsh restriction, for normally it is only parameters that are similar to each other that are tied to each other; derivatives with respect to similar parameters are normally calculated by similar means. If you forget this rule and inadvertently tie parameters together for which derivatives are indeed calculated by different means, PEST or PESTCHEK will detect the error and remind you of this.\nWhen using JUPITER protocol for supplying model-calculated derivatives to PEST when running in “predictive analysis” mode, there is no need to place the sole member of the observation group predict last in the list of observations. As in normal PEST operation, this can be placed anywhere within the “observation data” section of the PEST control file.\nDue to the fact that parameters and observations for which external derivatives are available are specifically identified in the derivatives interface file, a value of -1.11e33 signifying non-availability of a model-calculated derivative for a certain parameter with respect to a certain observation is not required. Hence this value is treated like any other.\nExternal derivatives can be supplied for a parameter irrespective of whether that parameter is adjustable or fixed. Thus the decision to fix a parameter can be made without reference to the manner in which derivatives are obtained.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers\n- **Main Section:** 12. Model-Calculated Derivatives (continuación)\n- **Subsection:** 12.6 JUPITER Protocol for External Derivatives\n\n### Additional Summaries\n- **Higher-Level Summary:** PEST uses pest.mmf to send messages before each run, indicating run type and parameter details. Different commands can be used for regular and derivative-calculating model runs, potentially reducing run time. Models can provide PEST with derivatives more efficiently, supporting various file formats. PEST control file variables manage model commands, messaging, and external derivatives.\n- **Detailed Summary:** PEST supports USGS JUPITER format external derivatives files, with specific formatting rules enforced by PEST and PESTCHEK. The JUPITER derivatives interface file contains DERFILE, NSKIP, NDEP/NPAR, ORIENTATION, DERFORMAT, parameter names, and dependent names. To use JUPITER external derivatives, set JACFILE to 2, specify DERCOM values, and prepare the interface file.\n\n### Related Context\n- **Previous Summary:** To use JUPITER external derivatives, set JACFILE to 2, specify DERCOM values, include a \"derivatives command line\" section (model command and derivatives interface filename), and prepare the derivatives interface file (described previously).  The EXTDERFLE variable now names the interface file.\n- **Next Summary:** For SVD-assisted inversion (SVDA_EXTSUPER≠1), PEST uses model-provided base parameter derivatives. Set JACFILE=1 and DERCOM=0 for all super parameters in the control file.  The external derivatives file must be uncompressed ASCII; JUPITER format and -1.11e33 values are not supported. A base parameter JCO file is still needed for initial super parameter definition and derivative calculation.\n\n### Metadata\n- **Keywords:** DERCOM, NOBS, NPAR\n- **Chunk ID:** 79af61e8b5fc\n- **Chunk Index:** 1\n- **Previous Chunk ID:** 7b384e1fb36b\n- **Next Chunk ID:** 923b0e08fd67\n\n---\n\n## Context\n\n### Summary\n**SCREENDISP (\"noverbose\" or \"verbose\") controls TEMPCHEK and INSCHEK screen output. NPAR matches the number of parameters in template and parameter variation files. NOBS matches the number of observations in instruction files. NTPFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS (\"single\" or \"double\") sets numerical precision (single usually suffices).**\n\n### Header\n**17.2.6 Control Data Section**\n\n### Content\nSCREENDISP\nSCREENDISP is a character variable which can take either one of two possible values. These values are “noverbose” and “verbose”. In the former case, when SENSAN runs TEMPCHEK and INSCHEK it redirects all of the screen output from these programs to the null file; hence the user is not aware that they are running. In the latter case, TEMPCHEK and INSCHEK output is directed to the screen in the usual fashion.\nOnce you have set up a SENSAN run and ensured that everything is working correctly, a nicer screen display is obtained by using the “noverbose” option. In this case you should ensure that the model likewise produces no screen output by redirecting its output to the null file using, for example, the command\nmodel > nul\nto run the model. For a UNIX system this command becomes\nmodel > /dev/null\nIf SENSAN is thus left to produce the only screen output, you can monitor its progress and detect any SENSAN error messages if they are written to the screen.\nNPAR\nThis is the number of parameters. It must agree with the number of parameters cited in the template file(s) used by SENSAN. It must also agree with the number of parameters named in the parameter variation file provided to SENSAN.\nNOBS\nNOBS is the number of “observations”, i.e. the number of model outcomes used in the sensitivity analysis process. It must agree with the number of observations cited in the instruction file(s) provided to SENSAN.\nNTPFLE\nNTPFLE is the number of template files to be used by SENSAN. For each template file there must be a corresponding model input file; see below. Note that a given template file can be used to write more than one model input file; however two templates cannot write the same model input file.\nNINSFLE\nNINSFLE is the number of instruction files used by SENSAN to read model outcomes. For each instruction file there must be a matching model output file. Note that the same instruction file cannot read more than one model output file (observation values would be overwritten); however two different instruction files can read the same model output file.\nPRECIS\nPRECIS is a character variable which must take either the value “single” or “double”. It determines whether single or double precision protocol is used to represent a very large or very small number, or a number in a wide parameter space; see section 2.2.6 for more details. The value “single” is usually appropriate.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers\n- **Main Section:** 17. SENSAN (continuación)\n- **Subsection:** 17.2 SENSAN File Requirements (continuación)\n\n### Additional Summaries\n- **Higher-Level Summary:** SENSAN uses control, parameter variation, and PEST template and instruction files. It runs system commands post-model runs, with options for OS commands or executables. PEST templates generate model inputs, instructions read outputs. Run with `sensan infile`, using tempchek.exe and inschek.exe. Outputs include ABSFLE, RELFLE, SENSFLE. SENSCHEK checks input data.\n- **Detailed Summary:** SENSAN utilizes a control file, parameter variation file, and PEST template and instruction files. It executes system commands after model runs, with options for operating system commands or executables. PEST template files are used to generate model input files, and instruction files are employed to read model outputs.\n\n### Related Context\n- **Previous Summary:** The SENSAN control file (Figure 17.2, recommended \".sns\" extension) starts with \"scf\", contains sections marked by \"*\", and uses many PEST variables. It includes control data, SENSAN files (parameter variation file, base output file, relative output file, sensitivity file), model command line, and model input/output (template and instruction files, Figure 17.3).\n- **Next Summary:** VARFLE names the parameter variation file (must match NPAR).  ABSFLE, RELFLE, and SENSFLE name SENSAN's output files (contents described below).\n\n### Metadata\n- **Keywords:** NINSFLE, NOBS, NPAR, PRECIS\n- **Chunk ID:** 6592c97ef380\n- **Chunk Index:** 1\n- **Previous Chunk ID:** e87ee1e03ea0\n- **Next Chunk ID:** c13ba89f9f8d\n\n---\n\n## Context\n\n### Summary\n**NPAR (total parameters), NOBS (observations, excluding dummy), NPARGP (parameter groups), NPRIOR (prior information items), and NOBSGP (observation groups) are integer variables in the PEST control file.  In \"estimation\" mode, adjustable parameters should not exceed weighted observations plus prior information, unless using SVD or LSQR. MAXCOMPDIM (optional) activates compressed Jacobian matrix storage.**\n\n### Header\n**4.2.4 Third Line**\n\n### Content\nNPAR\nThis is the total number of parameters featured in the current PEST case, including adjustable, fixed and tied parameters; NPAR must be supplied as an integer.\nNOBS\nThis integer variable represents the total number of observations featured in the current case. Note that, when counting the number of observations, dummy observations (see chapter 2) that may be featured in one or a number of instruction files are ignored.\nNPARGP\nThis is the number of parameter groups. Recall from the previous chapter that the variables which govern the operation of finite-difference derivatives are assigned to parameter groups. Parameter grouping can also be of importance where the ADDREG1 utility described in part II of this manual is employed to add preferred value Tikhonov regularisation to a PEST control file. NPARGP is an integer variable.\nNPRIOR\nNPRIOR, another integer variable, is the number of articles of prior information that are included in the parameter estimation process. If there are no articles of prior information, NPRIOR must be zero. If PEST is running in “estimation” mode, then you should ensure that the number of adjustable parameters is less than or equal to the number of observations for which there are non-zero weights plus the number of articles of prior information for which there are non-zero weights. If this is not the case, then the inverse problem cannot possibly have a unique solution. Furthermore, unless solution of this nonunique inverse problem is sought using singular value decomposition or LSQR, PEST may make little progress in lowering the objective function because the XtQX matrix appearing in equation 5.2.9 of Doherty (2015) will be singular and hence non-invertible. Sadly, nonuniqueness is the rule rather than the exception when calibrating environmental models. PEST is not troubled by parameter nonuniqueness if Tikhonov regularisation is introduced to the inverse problem, and if singular value decomposition or LSQR is used in solution of that problem. Because of the prevalence of nonuniqueness in environmental model calibration, this should be done as a matter of course. (The outnumbering of observations by parameters does not create a numerical problem if singular value decomposition or LSQR are used to solve the inverse problem, despite the noninvertability of XtQX.)\nNOBSGP\nNOBSGP, another integer variable, is the number of observation groups featured in the PEST control file. Each observation and each prior information equation must be assigned to an observation group (they can all be assigned to the same group if desired). When PEST evaluates the total objective function it also evaluates the contribution made to this total by each observation group.\nMAXCOMPDIM\nMAXCOMPDIM is an optional integer variable. It is used to activate compressed internal storage of the Jacobian matrix by PEST. This can slow PEST execution. At the same time it can allow PEST to undertake very highly parameterized inversion wherein adjustable parameters may number in the tens of thousands. This is further discussed in section 15.4.\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers\n- **Main Section:** 4. The PEST Control File\n- **Subsection:** 4.2 Control Data Section\n\n### Additional Summaries\n- **Higher-Level Summary:** Figure 4.2 in PEST software displays control data section variables. The text details options for writing matrices, files, and parameters, including settings for matrix and file saving, operational modes, precision, derivative handling, and convergence criteria. Optional features like sensitivity reuse and LSQR algorithm for solving inverse problems are discussed.\n- **Detailed Summary:** Figure 4.2 shows \"control data\" section variables (from Appendix A, Figure A1.1).  Some variables are discussed later. The first line must be \"* control data\";  some variables are optional (in brackets).\n\n### Related Context\n- **Previous Summary:** RSTFLE (\"restart\" or \"norestart\") enables PEST's restart capability (Appendix B). PESTMODE (\"estimation\", \"prediction\", \"regularisation\", or \"pareto\") selects the operational mode;  additional mode-specific sections may be included.\n- **Next Summary:** DERZEROLIM (optional) defines a Jacobian matrix zero threshold for compressed storage. NTPLFLE is the number of template files; NINSFLE is the number of instruction files. PRECIS (\"single\" or \"double\") sets precision. DPOINT (\"point\" or \"nopoint\") controls decimal point inclusion. NUMCOM, JACFILE, MESSFILE (Chapter 12) handle model-calculated derivatives. OBSREREF (Chapter 14) activates observation re-referencing.\n\n### Metadata\n- **Keywords:** MAXCOMPDIM, NOBS, NOBSGP, NPAR, NPARGP, NPRIOR\n- **Chunk ID:** 26873b456a9c\n- **Chunk Index:** 1\n- **Previous Chunk ID:** 9b2451e25955\n- **Next Chunk ID:** e611a7673cad\n\n---\n\n## Context\n\n### Summary\n**PEST accepts ASCII (number of columns, rows;  Figure 12.2) or compressed ASCII (NPAR, NOBS, NDIMCOMP;  Figure 12.3) external derivatives files.  Compressed files list only non-zero elements.  Binary versions (with NDIMCOMP, 4-byte integers, 8-byte doubles) are also supported.  PEST deletes existing files before running the model; errors indicate model failure or file writing issues.**\n\n### Header\n**12.4.3 File Formats**\n\n### Content\nASCII Uncompressed\nThe external derivatives file can be an ASCII (i.e. text) file in which numbers are separated by spaces, tabs or a comma (it is read by PEST using free field input). This file must be headed by a line containing two integers. These are the number of columns and rows comprising the following matrix. These numbers must be NPAR and NOBS respectively where NPAR is the number of parameters and NOBS is the number of observations cited in the PEST control file for the current case. The ordering of parameters and observations in the external derivatives file must be the same as that in the PEST control file. Note that a column must be included in the derivatives matrix for every parameter, even for those parameters which are tied or fixed (PEST ignores derivatives calculated with respect to fixed parameters). Similarly, there must be a row for every observation cited in the PEST control file, even for observations which are assigned a weight of zero.\nWhere there are many parameters to be estimated, each row representing the derivatives of a particular observation with respect to all parameters can be wrapped onto the next line (or as many lines as you wish). However derivatives for the next observation must begin on a new line.\nFigure 12.2 shows an example of an uncompressed ASCII external derivatives file.\n|4|9| | |\n|---|---|---|---|\n|5.00000|1707.60|34.4932|42.1234|\n|5.25066|8.79458|93.2321|23.5921|\n|1.04819|1.16448|5.34642|19.3235|\n|1.52323|0.11418|0.59235|75.2354|\n|3.21342|0.48392|9.49293|95.3459|\n|2.49321|5.39230|0.49332|9.22934|\n|19.4492|9.93024|0.49304|5.39234|\n|36.3444|10.4933|0.59439|6.49345|\n|95.4592|86.4234|47.4232|324.434|\nFigure 12.2 An uncompressed ASCII external derivatives file.\nASCII Compressed\nPEST provides an option for supplying the external derivatives file in a more compressed format than that illustrated in figure 12.2. This format is depicted in figure 12.3.\nNPAR NOBS NDIMCOMP\nIPAR1 IOBS1 DERIV(IOBS1,IPAR1)\nIPAR2 IOBS2 DERIV(IOBS2,IPAR2)\n..\nndimcomp times\nFigure 12.3 Format for a compressed ASCII external derivatives file.\nThe first line of a compressed external derivatives file should contain three integers, namely NPAR and NOBS (same as for the uncompressed alternative), and another entry named NDIMCOMP. NDIMCOMP must be set to 0, or to a positive number equal to the number of entries to follow. If it is set to 0 (or omitted), the following Jacobian matrix is assumed to adopt the protocol depicted in figure 12.2. If it is set to a positive number, it informs PEST\nthat NDIMCOMP lines of data follow in this file. Each of the following lines must contain three entries. The first two entries (IPAR and IOBS) are integers whereas the third ((DERIV(IOBS,IPAR)) is a real number (which can be double precision if desired). IPAR is the parameter number, while IOBS is the observation number; DERIV(IOBS, IPAR) is the element of the derivatives matrix corresponding to observation IOBS and parameter IPAR. Only non-zero elements of the derivatives matrix need to be supplied; missing elements are assumed to be zero.\nCompressed storage of an externally-supplied derivatives matrix can result in a dramatic reduction in the size of the external derivatives file where a large number of nonlinear (and hence model-calculated) regularisation constraints are used in the inversion process, for under these circumstances, the derivatives matrix normally has many zero-valued elements.\nBinary Compressed and Uncompressed\nBinary versions of the compressed and uncompressed external derivatives files described above can be read by PEST. However the following should be noted if supplying these types of file to PEST.\n- Optional variables cannot be supplied in binary files. Hence, irrespective of whether a full or compressed matrix is provided, the NDIMCOMP variable must be supplied in the header to a binary external derivatives file. If NDIMCOMP is set to zero, PEST takes this as a signal that the full matrix follows. If it is set to a positive number, this indicates the number of ensuing data lines. If it is supplied as a negative number, PEST ceases execution with an error message.\n- Integer values are expected as four byte numbers. However NCOMPDIM is expected to be of eight bytes length if an INTEL compiled version of PEST is employed. (This accommodates very large derivative matrices.)\n- Matrix elements are expected as double precision (eight bytes) real numbers.\nFile Management\nIf you notify PEST that the model will supply an external derivatives file, then you must also inform PEST of the name of this file, the protocol that it adopts for storage of matrix elements, and of the command which PEST must use to run the model in such a way that it writes this file. (The mechanism for accomplishing all of these is discussed below.) Just before issuing this command (it is issued once for every iteration of the inversion process) PEST first checks to see whether a derivatives file already exists. If such a file does exist, PEST deletes it. Thus if the model fails to run, PEST does not read the old file, mistaking it for the new one; instead it writes an error message to the screen informing you that the derivatives file cannot be found. Alternatively, if PEST issues an error message to the effect that it encountered a premature end to the external derivatives file, this indicates that either the model did not run to completion, or that there is an error in the code added to the model to write this file.\nDerivatives Type\n\n### Source\n- **File Name:** PEST Model-Independent Parameter Estimation. User Manual Part I: PEST, SENSAN and Global Optimisers\n- **Main Section:** 12. Model-Calculated Derivatives (continuación)\n- **Subsection:** 12.4 Externally-Supplied Derivatives\n\n### Additional Summaries\n- **Higher-Level Summary:** PEST uses pest.mmf to send messages before each run, indicating run type and parameter details. Different commands can be used for regular and derivative-calculating model runs, potentially reducing run time. Models can provide PEST with derivatives more efficiently, supporting various file formats. PEST control file variables manage model commands, messaging, and external derivatives.\n- **Detailed Summary:** Models can provide PEST with derivatives more efficiently than PEST's finite difference method. PEST can utilize these model-calculated derivatives via specially formatted external files, supporting ASCII, compressed ASCII, and binary formats. Models must be modified to create these files, which differ from PEST's Jacobian matrix and do not consider parameter transformations.\n\n### Related Context\n- **Previous Summary:** A model can provide PEST with derivatives via a specially formatted external derivatives file containing a derivatives matrix (rows=observations, columns=parameters).  This matrix differs from PEST's Jacobian matrix; it does not account for parameter transformations.  The model must be modified to create this file.\n- **Next Summary:** For log-transformed parameters, the model provides derivatives with respect to untransformed parameters; PEST handles the conversion internally.  Similarly, PEST accounts for SCALE and OFFSET values, so the model need not.\n\n### Metadata\n- **Keywords:** NOBS, NPAR\n- **Chunk ID:** cd22c15afc22\n- **Chunk Index:** 1\n- **Previous Chunk ID:** 423bada632b0\n- **Next Chunk ID:** fd8dcba7c21b\n\n---\n\n\nAnswer strictly following the above instructions.\n"
  }
]
```